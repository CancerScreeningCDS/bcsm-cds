<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1" localId="0">
   <annotation translatorVersion="3.11.0" translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion" signatureLevel="Overloads" xsi:type="a:CqlToElmInfo"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="1417">
         <a:s>/*  
  Author: CMS Alliance to Modernize Healthcare, operated by THE MITRE Corporation.

  (C) 2024 The MITRE Corporation. All Rights Reserved. 
  Approved for Public Release: 24-2711. 
  Distribution Unlimited.

  Unless otherwise noted, this work is available under an Apache 2.0 license. 
  It was produced by the MITRE Corporation for the Division of Cancer Prevention 
  and Control, Centers for Disease Control and Prevention in accordance with the 
  Statement of Work, contract number 75FCMC18D0047, task order number 75D30123F17931.
*/

library CSMCommonFunctions version '1.0.0'</a:s>
      </a:s>
   </annotation>
   <identifier id="CSMCommonFunctions" system="http://cancerscreeningcds.github.io/bcsm-cds" version="1.0.0"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localId="1" localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="206" locator="16:1-16:26" localIdentifier="FHIR" uri="http://hl7.org/fhir" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="206">
               <a:s>using </a:s>
               <a:s>
                  <a:s>FHIR</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="207" locator="18:1-18:63" localIdentifier="C3F" path="http://cancerscreeningcds.github.io/bcsm-cds/CDSConnectCommonsforFHIRv401" version="1.0.0">
         <annotation xsi:type="a:Annotation">
            <a:s r="207">
               <a:s>include </a:s>
               <a:s>
                  <a:s>CDSConnectCommonsforFHIRv401</a:s>
               </a:s>
               <a:s> version '1.0.0' called C3F</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="208" locator="19:1-19:54" localIdentifier="FHIRHelpers" path="http://cancerscreeningcds.github.io/bcsm-cds/FHIRHelpers" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="208">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.0.1' called FHIRHelpers</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <codeSystems>
      <def localId="209" locator="21:1-21:88" name="CONDVERSTATUS" id="http://terminology.hl7.org/CodeSystem/condition-ver-status" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="209">
               <a:s>codesystem &quot;CONDVERSTATUS&quot;: 'http://terminology.hl7.org/CodeSystem/condition-ver-status'</a:s>
            </a:s>
         </annotation>
      </def>
   </codeSystems>
   <codes>
      <def localId="210" locator="23:1-23:79" name="Condition Refuted code" id="refuted" display="Refuted" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="210">
               <a:s>code &quot;Condition Refuted code&quot;: 'refuted' from </a:s>
               <a:s r="211">
                  <a:s>&quot;CONDVERSTATUS&quot;</a:s>
               </a:s>
               <a:s> display 'Refuted'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="211" locator="23:47-23:61" name="CONDVERSTATUS"/>
      </def>
      <def localId="212" locator="24:1-24:106" name="Condition Entered in Error code" id="entered-in-error" display="Entered in Error" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="212">
               <a:s>code &quot;Condition Entered in Error code&quot;: 'entered-in-error' from </a:s>
               <a:s r="213">
                  <a:s>&quot;CONDVERSTATUS&quot;</a:s>
               </a:s>
               <a:s> display 'Entered in Error'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="213" locator="24:65-24:79" name="CONDVERSTATUS"/>
      </def>
   </codes>
   <concepts>
      <def localId="214" locator="26:1-26:75" name="Condition Refuted" display="Refuted" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="214">
               <a:s>concept &quot;Condition Refuted&quot;: { </a:s>
               <a:s r="215">
                  <a:s>&quot;Condition Refuted code&quot;</a:s>
               </a:s>
               <a:s> } display 'Refuted'</a:s>
            </a:s>
         </annotation>
         <code localId="215" locator="26:32-26:55" name="Condition Refuted code"/>
      </def>
      <def localId="216" locator="27:1-27:102" name="Condition Entered in Error" display="Entered in Error" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="216">
               <a:s>concept &quot;Condition Entered in Error&quot;: { </a:s>
               <a:s r="217">
                  <a:s>&quot;Condition Entered in Error code&quot;</a:s>
               </a:s>
               <a:s> } display 'Entered in Error'</a:s>
            </a:s>
         </annotation>
         <code localId="217" locator="27:41-27:73" name="Condition Entered in Error code"/>
      </def>
   </concepts>
   <statements>
      <def localId="218" locator="40:1-41:73" name="ConceptText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="218">
               <a:s>/*******************************************************************************
 * NOTICE: This following code has been adapted from &quot;Factors to Consider in 
 * Managing Chronic Pain: A Pain Management Summary,&quot; available at:
 * https://cds.ahrq.gov/cdsconnect/artifact/factors-consider-managing-chronic-pain-pain-management-summary
 * It is made available via an Apache 2.0 license.
*******************************************************************************/

// Returns the first-found display text for a CodeableConcept, looking first at the `text` attribute, then the
// `display` on each `coding` until it finds a non-null value.  Some PEG codes are normalized due to length.
// @param c - a FHIR CodeableConcept to get text from
// @returns {System.String} the display text or null if none is found
define function ConceptText(c FHIR.CodeableConcept):
  </a:s>
               <a:s r="237">
                  <a:s r="237">
                     <a:s>Coalesce(</a:s>
                     <a:s r="223">
                        <a:s r="222">
                           <a:s r="221">
                              <a:s>c</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="222">
                              <a:s>text</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="223">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>, </a:s>
                     <a:s r="234">
                        <a:s>Coalesce(</a:s>
                        <a:s r="231">
                           <a:s>
                              <a:s r="224">
                                 <a:s r="226">
                                    <a:s>(</a:s>
                                    <a:s r="226">
                                       <a:s r="225">
                                          <a:s>c</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="226">
                                          <a:s>coding</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> c2</a:s>
                              </a:s>
                           </a:s>
                           <a:s> </a:s>
                           <a:s r="227">
                              <a:s>return </a:s>
                              <a:s r="230">
                                 <a:s r="229">
                                    <a:s r="228">
                                       <a:s>c2</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="229">
                                       <a:s>display</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="230">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="237" locator="41:3-41:73" xsi:type="Coalesce">
            <operand localId="223" locator="41:12-41:23" path="value" xsi:type="Property">
               <source localId="222" locator="41:12-41:17" path="text" xsi:type="Property">
                  <source localId="221" locator="41:12" name="c" xsi:type="OperandRef"/>
               </source>
            </operand>
            <operand localId="234" locator="41:26-41:72" xsi:type="Coalesce">
               <operand localId="231" locator="41:35-41:71" xsi:type="Query">
                  <source localId="224" locator="41:35-41:47" alias="c2">
                     <expression localId="226" locator="41:35-41:44" path="coding" xsi:type="Property">
                        <source localId="225" locator="41:36" name="c" xsi:type="OperandRef"/>
                     </expression>
                  </source>
                  <return localId="227" locator="41:49-41:71">
                     <expression localId="230" locator="41:56-41:71" path="value" xsi:type="Property">
                        <source localId="229" locator="41:56-41:65" path="display" scope="c2" xsi:type="Property"/>
                     </expression>
                  </return>
               </operand>
            </operand>
         </expression>
         <operand localId="220" name="c">
            <operandTypeSpecifier localId="219" locator="40:31-40:50" name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="238" locator="46:1-47:19" name="DateText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="238">
               <a:s>// Returns a text representation of a date using the CQL `ToString` function.
// @param d - a FHIR date to get text for
// @returns {System.String} the text representation of the date
define function DateText(d FHIR.date):
  </a:s>
               <a:s r="246">
                  <a:s r="246">
                     <a:s>ToString(</a:s>
                     <a:s r="242">
                        <a:s r="241">
                           <a:s>d</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="242">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="246" locator="47:3-47:19" xsi:type="ToString">
            <signature localId="247" name="t:Date" xsi:type="NamedTypeSpecifier"/>
            <operand localId="242" locator="47:12-47:18" path="value" xsi:type="Property">
               <source localId="241" locator="47:12" name="d" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand localId="240" name="d">
            <operandTypeSpecifier localId="239" locator="46:28-46:36" name="fhir:date" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="248" locator="52:1-53:47" name="DateTimeText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="248">
               <a:s>// Returns a text representation of a dateTime using the CQL `ToString` function.
// @param d - a FHIR dateTime to get text for
// @returns {System.String} the text representation of the date portion of the dateTime
define function DateTimeText(d FHIR.dateTime):
  </a:s>
               <a:s r="264">
                  <a:s r="264">
                     <a:s>First(</a:s>
                     <a:s r="261">
                        <a:s>SplitOnMatches(</a:s>
                        <a:s r="256">
                           <a:s>ToString(</a:s>
                           <a:s r="252">
                              <a:s r="251">
                                 <a:s>d</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="252">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="258">
                           <a:s>'T'</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="264" locator="53:3-53:47" xsi:type="First">
            <source localId="261" locator="53:9-53:46" xsi:type="SplitOnMatches">
               <stringToSplit localId="256" locator="53:24-53:40" xsi:type="ToString">
                  <signature localId="257" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="252" locator="53:33-53:39" path="value" xsi:type="Property">
                     <source localId="251" locator="53:33" name="d" xsi:type="OperandRef"/>
                  </operand>
               </stringToSplit>
               <separatorPattern localId="258" locator="53:43-53:45" valueType="t:String" value="T" xsi:type="Literal"/>
            </source>
         </expression>
         <operand localId="250" name="d">
            <operandTypeSpecifier localId="249" locator="52:32-52:44" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="265" locator="58:1-59:19" name="InstantText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="265">
               <a:s>// Returns a text representation of an instant using the CQL `ToString` function.
// @param i - a FHIR instant to get text for
// @returns {System.String} the text representation of the instant
define function InstantText(i FHIR.instant):
  </a:s>
               <a:s r="273">
                  <a:s r="273">
                     <a:s>ToString(</a:s>
                     <a:s r="269">
                        <a:s r="268">
                           <a:s>i</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="269">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="273" locator="59:3-59:19" xsi:type="ToString">
            <signature localId="274" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <operand localId="269" locator="59:12-59:18" path="value" xsi:type="Property">
               <source localId="268" locator="59:12" name="i" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand localId="267" name="i">
            <operandTypeSpecifier localId="266" locator="58:31-58:42" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="275" locator="65:1-69:30" name="QuantityText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="275">
               <a:s>// Returns a text representation of a Quantity with the Quantity's value and unit.
// If the unit is {score}, then omit it (as it is not useful to display)
// @param q - a FHIR Quantity to get text for
// @returns {System.String} the text representation of the Quantity
define function QuantityText(q FHIR.Quantity):
  </a:s>
               <a:s r="278">
                  <a:s r="278">
                     <a:s>if </a:s>
                     <a:s r="280">
                        <a:s>(</a:s>
                        <a:s r="280">
                           <a:s r="279">
                              <a:s>q</a:s>
                           </a:s>
                           <a:s> is null</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s r="281"> then null
  else </a:s>
                     <a:s r="282">
                        <a:s>if </a:s>
                        <a:s r="286">
                           <a:s>(</a:s>
                           <a:s r="286">
                              <a:s r="284">
                                 <a:s r="283">
                                    <a:s>q</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="284">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> is not null</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="306">
                           <a:s r="300">
                              <a:s r="295">
                                 <a:s>ToString(</a:s>
                                 <a:s r="291">
                                    <a:s r="290">
                                       <a:s r="289">
                                          <a:s>q</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="290">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="291">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> + </a:s>
                              <a:s r="297">
                                 <a:s>' '</a:s>
                              </a:s>
                           </a:s>
                           <a:s> + </a:s>
                           <a:s r="303">
                              <a:s r="302">
                                 <a:s r="301">
                                    <a:s>q</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="302">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="303">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  else </a:s>
                        <a:s r="307">
                           <a:s>if </a:s>
                           <a:s r="311">
                              <a:s>(</a:s>
                              <a:s r="311">
                                 <a:s r="309">
                                    <a:s r="308">
                                       <a:s>q</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="309">
                                       <a:s>code</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> is not null</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> then </a:s>
                           <a:s r="331">
                              <a:s r="325">
                                 <a:s r="320">
                                    <a:s>ToString(</a:s>
                                    <a:s r="316">
                                       <a:s r="315">
                                          <a:s r="314">
                                             <a:s>q</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="315">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="316">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="322">
                                    <a:s>' '</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> + </a:s>
                              <a:s r="328">
                                 <a:s r="327">
                                    <a:s r="326">
                                       <a:s>q</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="327">
                                       <a:s>code</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="328">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
  else </a:s>
                           <a:s r="338">
                              <a:s>ToString(</a:s>
                              <a:s r="334">
                                 <a:s r="333">
                                    <a:s r="332">
                                       <a:s>q</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="333">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="334">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="278" locator="66:3-69:30" xsi:type="If">
            <condition localId="280" locator="66:6-66:16" xsi:type="IsNull">
               <operand localId="279" locator="66:7" name="q" xsi:type="OperandRef"/>
            </condition>
            <then localId="340" asType="t:String" xsi:type="As">
               <operand localId="281" locator="66:23-66:26" xsi:type="Null"/>
            </then>
            <else localId="282" locator="67:8-69:30" xsi:type="If">
               <condition localId="286" locator="67:11-67:30" xsi:type="Not">
                  <operand localId="285" locator="67:12-67:29" xsi:type="IsNull">
                     <operand localId="284" locator="67:12-67:17" path="unit" xsi:type="Property">
                        <source localId="283" locator="67:12" name="q" xsi:type="OperandRef"/>
                     </operand>
                  </operand>
               </condition>
               <then localId="306" locator="67:37-67:80" xsi:type="Concatenate">
                  <operand localId="300" locator="67:37-67:65" xsi:type="Concatenate">
                     <operand localId="295" locator="67:37-67:59" xsi:type="ToString">
                        <signature localId="296" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="291" locator="67:46-67:58" path="value" xsi:type="Property">
                           <source localId="290" locator="67:46-67:52" path="value" xsi:type="Property">
                              <source localId="289" locator="67:46" name="q" xsi:type="OperandRef"/>
                           </source>
                        </operand>
                     </operand>
                     <operand localId="297" locator="67:63-67:65" valueType="t:String" value=" " xsi:type="Literal"/>
                  </operand>
                  <operand localId="303" locator="67:69-67:80" path="value" xsi:type="Property">
                     <source localId="302" locator="67:69-67:74" path="unit" xsi:type="Property">
                        <source localId="301" locator="67:69" name="q" xsi:type="OperandRef"/>
                     </source>
                  </operand>
               </then>
               <else localId="307" locator="68:8-69:30" xsi:type="If">
                  <condition localId="311" locator="68:11-68:30" xsi:type="Not">
                     <operand localId="310" locator="68:12-68:29" xsi:type="IsNull">
                        <operand localId="309" locator="68:12-68:17" path="code" xsi:type="Property">
                           <source localId="308" locator="68:12" name="q" xsi:type="OperandRef"/>
                        </operand>
                     </operand>
                  </condition>
                  <then localId="331" locator="68:37-68:80" xsi:type="Concatenate">
                     <operand localId="325" locator="68:37-68:65" xsi:type="Concatenate">
                        <operand localId="320" locator="68:37-68:59" xsi:type="ToString">
                           <signature localId="321" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="316" locator="68:46-68:58" path="value" xsi:type="Property">
                              <source localId="315" locator="68:46-68:52" path="value" xsi:type="Property">
                                 <source localId="314" locator="68:46" name="q" xsi:type="OperandRef"/>
                              </source>
                           </operand>
                        </operand>
                        <operand localId="322" locator="68:63-68:65" valueType="t:String" value=" " xsi:type="Literal"/>
                     </operand>
                     <operand localId="328" locator="68:69-68:80" path="value" xsi:type="Property">
                        <source localId="327" locator="68:69-68:74" path="code" xsi:type="Property">
                           <source localId="326" locator="68:69" name="q" xsi:type="OperandRef"/>
                        </source>
                     </operand>
                  </then>
                  <else localId="338" locator="69:8-69:30" xsi:type="ToString">
                     <signature localId="339" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="334" locator="69:17-69:29" path="value" xsi:type="Property">
                        <source localId="333" locator="69:17-69:23" path="value" xsi:type="Property">
                           <source localId="332" locator="69:17" name="q" xsi:type="OperandRef"/>
                        </source>
                     </operand>
                  </else>
               </else>
            </else>
         </expression>
         <operand localId="277" name="q">
            <operandTypeSpecifier localId="276" locator="65:32-65:44" name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="341" locator="74:1-80:5" name="PeriodObject" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="341">
               <a:s>// Returns a tuple containing a Period's start and end as text representations.
// @param p - a FHIR Period to get a tuple for
// @returns {Tuple&lt;Start System.String, End System.String>} the tuple representation of the Period
define function PeriodObject(p FHIR.Period):
  </a:s>
               <a:s r="344">
                  <a:s r="344">
                     <a:s>if </a:s>
                     <a:s r="346">
                        <a:s r="345">
                           <a:s>p</a:s>
                        </a:s>
                        <a:s> is null</a:s>
                     </a:s>
                     <a:s r="347"> then null
  else
    </a:s>
                     <a:s r="348">
                        <a:s>{
      </a:s>
                        <a:s>
                           <a:s>Start: </a:s>
                           <a:s r="351">
                              <a:s>DateTimeText(</a:s>
                              <a:s r="350">
                                 <a:s r="349">
                                    <a:s>p</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="350">
                                    <a:s>&quot;start&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s>
                           <a:s>End: </a:s>
                           <a:s r="354">
                              <a:s>DateTimeText(</a:s>
                              <a:s r="353">
                                 <a:s r="352">
                                    <a:s>p</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="353">
                                    <a:s>&quot;end&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
    }</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="344" locator="75:3-80:5" xsi:type="If">
            <condition localId="346" locator="75:6-75:14" xsi:type="IsNull">
               <operand localId="345" locator="75:6" name="p" xsi:type="OperandRef"/>
            </condition>
            <then localId="355" xsi:type="As">
               <operand localId="347" locator="75:21-75:24" xsi:type="Null"/>
               <asTypeSpecifier localId="356" xsi:type="TupleTypeSpecifier">
                  <element localId="357" name="Start">
                     <elementType localId="358" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </element>
                  <element localId="359" name="End">
                     <elementType localId="360" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </element>
               </asTypeSpecifier>
            </then>
            <else localId="348" locator="77:5-80:5" xsi:type="Tuple">
               <element name="Start">
                  <value localId="351" locator="78:14-78:36" name="DateTimeText" xsi:type="FunctionRef">
                     <operand localId="350" locator="78:27-78:35" path="start" xsi:type="Property">
                        <source localId="349" locator="78:27" name="p" xsi:type="OperandRef"/>
                     </operand>
                  </value>
               </element>
               <element name="End">
                  <value localId="354" locator="79:12-79:32" name="DateTimeText" xsi:type="FunctionRef">
                     <operand localId="353" locator="79:25-79:31" path="end" xsi:type="Property">
                        <source localId="352" locator="79:25" name="p" xsi:type="OperandRef"/>
                     </operand>
                  </value>
               </element>
            </else>
         </expression>
         <operand localId="343" name="p">
            <operandTypeSpecifier localId="342" locator="74:32-74:42" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="361" locator="85:1-91:5" name="RangeObject" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="361">
               <a:s>// Returns a tuple containing a Range's low and high as text representations.
// @param r - a FHIR Range to get a tuple for
// @returns {Tuple&lt;Low System.String, High System.String>} the tuple representation of the Range
define function RangeObject(r FHIR.Range):
  </a:s>
               <a:s r="364">
                  <a:s r="364">
                     <a:s>if </a:s>
                     <a:s r="366">
                        <a:s r="365">
                           <a:s>r</a:s>
                        </a:s>
                        <a:s> is null</a:s>
                     </a:s>
                     <a:s r="367"> then null
  else
    </a:s>
                     <a:s r="368">
                        <a:s>{
      </a:s>
                        <a:s>
                           <a:s>Low: </a:s>
                           <a:s r="371">
                              <a:s>QuantityText(</a:s>
                              <a:s r="370">
                                 <a:s r="369">
                                    <a:s>r</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="370">
                                    <a:s>low</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s>
                           <a:s>High: </a:s>
                           <a:s r="374">
                              <a:s>QuantityText(</a:s>
                              <a:s r="373">
                                 <a:s r="372">
                                    <a:s>r</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="373">
                                    <a:s>high</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
    }</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="364" locator="86:3-91:5" xsi:type="If">
            <condition localId="366" locator="86:6-86:14" xsi:type="IsNull">
               <operand localId="365" locator="86:6" name="r" xsi:type="OperandRef"/>
            </condition>
            <then localId="375" xsi:type="As">
               <operand localId="367" locator="86:21-86:24" xsi:type="Null"/>
               <asTypeSpecifier localId="376" xsi:type="TupleTypeSpecifier">
                  <element localId="377" name="Low">
                     <elementType localId="378" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </element>
                  <element localId="379" name="High">
                     <elementType localId="380" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </element>
               </asTypeSpecifier>
            </then>
            <else localId="368" locator="88:5-91:5" xsi:type="Tuple">
               <element name="Low">
                  <value localId="371" locator="89:12-89:30" name="QuantityText" xsi:type="FunctionRef">
                     <operand localId="370" locator="89:25-89:29" path="low" xsi:type="Property">
                        <source localId="369" locator="89:25" name="r" xsi:type="OperandRef"/>
                     </operand>
                  </value>
               </element>
               <element name="High">
                  <value localId="374" locator="90:13-90:32" name="QuantityText" xsi:type="FunctionRef">
                     <operand localId="373" locator="90:26-90:31" path="high" xsi:type="Property">
                        <source localId="372" locator="90:26" name="r" xsi:type="OperandRef"/>
                     </operand>
                  </value>
               </element>
            </else>
         </expression>
         <operand localId="363" name="r">
            <operandTypeSpecifier localId="362" locator="85:31-85:40" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="381" locator="93:1-100:3" name="ObservationDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="381">
               <a:s>define function ObservationDate(o FHIR.Observation):
  </a:s>
               <a:s r="413">
                  <a:s r="413">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="388">
                        <a:s r="384">
                           <a:s>(</a:s>
                           <a:s r="384">
                              <a:s r="386">
                                 <a:s r="385">
                                    <a:s>o</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="386">
                                    <a:s>effective</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="387">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="388">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="393">
                        <a:s r="389">
                           <a:s>(</a:s>
                           <a:s r="389">
                              <a:s r="391">
                                 <a:s r="390">
                                    <a:s>o</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="391">
                                    <a:s>effective</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="392">
                                 <a:s>FHIR.instant</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="393">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="399">
                        <a:s r="398">
                           <a:s r="394">
                              <a:s>(</a:s>
                              <a:s r="394">
                                 <a:s r="396">
                                    <a:s r="395">
                                       <a:s>o</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="396">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="397">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="398">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="399">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="405">
                        <a:s r="404">
                           <a:s r="400">
                              <a:s>(</a:s>
                              <a:s r="400">
                                 <a:s r="402">
                                    <a:s r="401">
                                       <a:s>o</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="402">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="403">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="404">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="405">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="410">
                        <a:s r="406">
                           <a:s>(</a:s>
                           <a:s r="406">
                              <a:s r="408">
                                 <a:s r="407">
                                    <a:s>o</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="408">
                                    <a:s>issued</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="409">
                                 <a:s>FHIR.instant</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="410">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="413" locator="94:3-100:3" xsi:type="Coalesce">
            <operand localId="388" locator="95:5-95:40" path="value" xsi:type="Property">
               <source localId="384" locator="95:5-95:34" strict="false" xsi:type="As">
                  <operand localId="386" locator="95:6-95:16" path="effective" xsi:type="Property">
                     <source localId="385" locator="95:6" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="387" locator="95:21-95:33" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="393" locator="96:5-96:39" path="value" xsi:type="Property">
               <source localId="389" locator="96:5-96:33" strict="false" xsi:type="As">
                  <operand localId="391" locator="96:6-96:16" path="effective" xsi:type="Property">
                     <source localId="390" locator="96:6" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="392" locator="96:21-96:32" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="399" locator="97:5-97:44" path="value" xsi:type="Property">
               <source localId="398" locator="97:5-97:38" path="end" xsi:type="Property">
                  <source localId="394" locator="97:5-97:32" strict="false" xsi:type="As">
                     <operand localId="396" locator="97:6-97:16" path="effective" xsi:type="Property">
                        <source localId="395" locator="97:6" name="o" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="397" locator="97:21-97:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="405" locator="98:5-98:46" path="value" xsi:type="Property">
               <source localId="404" locator="98:5-98:40" path="start" xsi:type="Property">
                  <source localId="400" locator="98:5-98:32" strict="false" xsi:type="As">
                     <operand localId="402" locator="98:6-98:16" path="effective" xsi:type="Property">
                        <source localId="401" locator="98:6" name="o" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="403" locator="98:21-98:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="410" locator="99:5-99:36" path="value" xsi:type="Property">
               <source localId="406" locator="99:5-99:30" strict="false" xsi:type="As">
                  <operand localId="408" locator="99:6-99:13" path="issued" xsi:type="Property">
                     <source localId="407" locator="99:6" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="409" locator="99:18-99:29" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
         </expression>
         <operand localId="383" name="o">
            <operandTypeSpecifier localId="382" locator="93:35-93:50" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="414" locator="106:1-113:3" name="ObservationDateString" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="414">
               <a:s>// Returns a text representation of a date associated with an Observation, preferring `effectiveDateTime`, then
// `effectivePeriod.start`, then `issued`.
// @param o - a FHIR Observation to get the text date from
// @returns {System.String} the text representation of a relevant date from the Observation
define function ObservationDateString(o FHIR.Observation):
  </a:s>
               <a:s r="449">
                  <a:s r="449">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="421">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="417">
                           <a:s r="419">
                              <a:s r="418">
                                 <a:s>o</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="419">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="420">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="426">
                        <a:s>InstantText(</a:s>
                        <a:s r="422">
                           <a:s r="424">
                              <a:s r="423">
                                 <a:s>o</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="424">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="425">
                              <a:s>FHIR.instant</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="432">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="431">
                           <a:s r="427">
                              <a:s>(</a:s>
                              <a:s r="427">
                                 <a:s r="429">
                                    <a:s r="428">
                                       <a:s>o</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="429">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="430">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="431">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="438">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="437">
                           <a:s r="433">
                              <a:s>(</a:s>
                              <a:s r="433">
                                 <a:s r="435">
                                    <a:s r="434">
                                       <a:s>o</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="435">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="436">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="437">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="441">
                        <a:s>InstantText(</a:s>
                        <a:s r="440">
                           <a:s r="439">
                              <a:s>o</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="440">
                              <a:s>issued</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="449" locator="107:3-113:3" xsi:type="Coalesce">
            <signature localId="450" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="451" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="452" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="453" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="454" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <operand localId="421" locator="108:5-108:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="417" locator="108:18-108:45" strict="false" xsi:type="As">
                  <operand localId="419" locator="108:18-108:28" path="effective" xsi:type="Property">
                     <source localId="418" locator="108:18" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="420" locator="108:33-108:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="426" locator="109:5-109:44" name="InstantText" xsi:type="FunctionRef">
               <operand localId="422" locator="109:17-109:43" strict="false" xsi:type="As">
                  <operand localId="424" locator="109:17-109:27" path="effective" xsi:type="Property">
                     <source localId="423" locator="109:17" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="425" locator="109:32-109:43" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="432" locator="110:5-110:52" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="431" locator="110:18-110:51" path="end" xsi:type="Property">
                  <source localId="427" locator="110:18-110:45" strict="false" xsi:type="As">
                     <operand localId="429" locator="110:19-110:29" path="effective" xsi:type="Property">
                        <source localId="428" locator="110:19" name="o" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="430" locator="110:34-110:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="438" locator="111:5-111:54" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="437" locator="111:18-111:53" path="start" xsi:type="Property">
                  <source localId="433" locator="111:18-111:45" strict="false" xsi:type="As">
                     <operand localId="435" locator="111:19-111:29" path="effective" xsi:type="Property">
                        <source localId="434" locator="111:19" name="o" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="436" locator="111:34-111:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="441" locator="112:5-112:25" name="InstantText" xsi:type="FunctionRef">
               <operand localId="440" locator="112:17-112:24" path="issued" xsi:type="Property">
                  <source localId="439" locator="112:17" name="o" xsi:type="OperandRef"/>
               </operand>
            </operand>
         </expression>
         <operand localId="416" name="o">
            <operandTypeSpecifier localId="415" locator="106:41-106:56" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="455" locator="119:1-124:3" name="MedicationStatementDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="455">
               <a:s>// Returns a text representation of a date associated with a MedicationStatement, preferring `effectiveDateTime`, then
// `.start`.
// @param s - a FHIR MedicationStatement to get the text date from
// @returns {System.String} the text representation of a relevant date from the MedicationStatement
define function MedicationStatementDate(s FHIR.MedicationStatement):
  </a:s>
               <a:s r="477">
                  <a:s r="477">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="462">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="458">
                           <a:s r="460">
                              <a:s r="459">
                                 <a:s>s</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="460">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="461">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="468">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="467">
                           <a:s r="463">
                              <a:s>(</a:s>
                              <a:s r="463">
                                 <a:s r="465">
                                    <a:s r="464">
                                       <a:s>s</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="465">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="466">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="467">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="474">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="473">
                           <a:s r="469">
                              <a:s>(</a:s>
                              <a:s r="469">
                                 <a:s r="471">
                                    <a:s r="470">
                                       <a:s>s</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="471">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="472">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="473">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="477" locator="120:3-124:3" xsi:type="Coalesce">
            <operand localId="462" locator="121:5-121:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="458" locator="121:18-121:45" strict="false" xsi:type="As">
                  <operand localId="460" locator="121:18-121:28" path="effective" xsi:type="Property">
                     <source localId="459" locator="121:18" name="s" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="461" locator="121:33-121:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="468" locator="122:5-122:52" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="467" locator="122:18-122:51" path="end" xsi:type="Property">
                  <source localId="463" locator="122:18-122:45" strict="false" xsi:type="As">
                     <operand localId="465" locator="122:19-122:29" path="effective" xsi:type="Property">
                        <source localId="464" locator="122:19" name="s" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="466" locator="122:34-122:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="474" locator="123:5-123:54" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="473" locator="123:18-123:53" path="start" xsi:type="Property">
                  <source localId="469" locator="123:18-123:45" strict="false" xsi:type="As">
                     <operand localId="471" locator="123:19-123:29" path="effective" xsi:type="Property">
                        <source localId="470" locator="123:19" name="s" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="472" locator="123:34-123:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
         </expression>
         <operand localId="457" name="s">
            <operandTypeSpecifier localId="456" locator="119:43-119:66" name="fhir:MedicationStatement" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="478" locator="130:1-137:4" name="Onset" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="478">
               <a:s>// Returns a text representation of a Condition's onset, whether represented as a dateTime, Period, Quantity (Age),
// Range (Age), or string.
// @param c - a FHIR Condition to get the text representation of the onset from
// @returns {System.String} the text representation of the Condition's onset
define function Onset(c FHIR.Condition):
  </a:s>
               <a:s r="511">
                  <a:s r="511">
                     <a:s>Coalesce( </a:s>
                     <a:s r="481">
                        <a:s>List{
    </a:s>
                        <a:s r="486">
                           <a:s>DateTimeText(</a:s>
                           <a:s r="482">
                              <a:s r="484">
                                 <a:s r="483">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="484">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="485">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="491">
                           <a:s>QuantityText(</a:s>
                           <a:s r="487">
                              <a:s r="489">
                                 <a:s r="488">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="489">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="490">
                                 <a:s>FHIR.Age</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="496">
                           <a:s>PeriodObject(</a:s>
                           <a:s r="492">
                              <a:s r="494">
                                 <a:s r="493">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="494">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="495">
                                 <a:s>FHIR.Period</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="501">
                           <a:s>RangeObject(</a:s>
                           <a:s r="497">
                              <a:s r="499">
                                 <a:s r="498">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="499">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="500">
                                 <a:s>FHIR.Range</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="506">
                           <a:s r="502">
                              <a:s>(</a:s>
                              <a:s r="502">
                                 <a:s r="504">
                                    <a:s r="503">
                                       <a:s>c</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="504">
                                       <a:s>onset</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="505">
                                    <a:s>FHIR.string</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="506">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  }</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="511" locator="131:3-137:4" xsi:type="Coalesce">
            <signature localId="512" xsi:type="ListTypeSpecifier">
               <elementType localId="513" name="t:Any" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="481" locator="131:13-137:3" xsi:type="List">
               <element localId="486" locator="132:5-132:42" name="DateTimeText" xsi:type="FunctionRef">
                  <operand localId="482" locator="132:18-132:41" strict="false" xsi:type="As">
                     <operand localId="484" locator="132:18-132:24" path="onset" xsi:type="Property">
                        <source localId="483" locator="132:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="485" locator="132:29-132:41" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="491" locator="133:5-133:37" name="QuantityText" xsi:type="FunctionRef">
                  <operand localId="487" locator="133:18-133:36" strict="false" xsi:type="As">
                     <operand localId="489" locator="133:18-133:24" path="onset" xsi:type="Property">
                        <source localId="488" locator="133:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="490" locator="133:29-133:36" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="496" locator="134:5-134:40" name="PeriodObject" xsi:type="FunctionRef">
                  <operand localId="492" locator="134:18-134:39" strict="false" xsi:type="As">
                     <operand localId="494" locator="134:18-134:24" path="onset" xsi:type="Property">
                        <source localId="493" locator="134:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="495" locator="134:29-134:39" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="501" locator="135:5-135:38" name="RangeObject" xsi:type="FunctionRef">
                  <operand localId="497" locator="135:17-135:37" strict="false" xsi:type="As">
                     <operand localId="499" locator="135:17-135:23" path="onset" xsi:type="Property">
                        <source localId="498" locator="135:17" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="500" locator="135:28-135:37" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="506" locator="136:5-136:34" path="value" xsi:type="Property">
                  <source localId="502" locator="136:5-136:28" strict="false" xsi:type="As">
                     <operand localId="504" locator="136:6-136:12" path="onset" xsi:type="Property">
                        <source localId="503" locator="136:6" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="505" locator="136:17-136:27" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </element>
            </operand>
         </expression>
         <operand localId="480" name="c">
            <operandTypeSpecifier localId="479" locator="130:25-130:38" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="514" locator="143:1-150:4" name="Abatement" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="514">
               <a:s>// Returns a text representation of a Condition's abatement, whether represented as a dateTime, Period, Quantity (Age),
// Range (Age), string, or boolean.
// @param c - a FHIR Condition to get the text representation of the abatement from
// @returns {System.String} the text representation of the Condition's abatement
define function Abatement(c FHIR.Condition):
  </a:s>
               <a:s r="542">
                  <a:s r="542">
                     <a:s>Coalesce( </a:s>
                     <a:s r="517">
                        <a:s>List{
    </a:s>
                        <a:s r="522">
                           <a:s>DateTimeText(</a:s>
                           <a:s r="518">
                              <a:s r="520">
                                 <a:s r="519">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="520">
                                    <a:s>abatement</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="521">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    // QuantityText(c.abatement as FHIR.Age),
    </a:s>
                        <a:s r="527">
                           <a:s>PeriodObject(</a:s>
                           <a:s r="523">
                              <a:s r="525">
                                 <a:s r="524">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="525">
                                    <a:s>abatement</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="526">
                                 <a:s>FHIR.Period</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="532">
                           <a:s>RangeObject(</a:s>
                           <a:s r="528">
                              <a:s r="530">
                                 <a:s r="529">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="530">
                                    <a:s>abatement</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="531">
                                 <a:s>FHIR.Range</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="537">
                           <a:s r="533">
                              <a:s>(</a:s>
                              <a:s r="533">
                                 <a:s r="535">
                                    <a:s r="534">
                                       <a:s>c</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="535">
                                       <a:s>abatement</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="536">
                                    <a:s>FHIR.string</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="537">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  }</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="542" locator="144:3-150:4" xsi:type="Coalesce">
            <signature localId="543" xsi:type="ListTypeSpecifier">
               <elementType localId="544" name="t:Any" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="517" locator="144:13-150:3" xsi:type="List">
               <element localId="522" locator="145:5-145:46" name="DateTimeText" xsi:type="FunctionRef">
                  <operand localId="518" locator="145:18-145:45" strict="false" xsi:type="As">
                     <operand localId="520" locator="145:18-145:28" path="abatement" xsi:type="Property">
                        <source localId="519" locator="145:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="521" locator="145:33-145:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="527" locator="147:5-147:44" name="PeriodObject" xsi:type="FunctionRef">
                  <operand localId="523" locator="147:18-147:43" strict="false" xsi:type="As">
                     <operand localId="525" locator="147:18-147:28" path="abatement" xsi:type="Property">
                        <source localId="524" locator="147:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="526" locator="147:33-147:43" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="532" locator="148:5-148:42" name="RangeObject" xsi:type="FunctionRef">
                  <operand localId="528" locator="148:17-148:41" strict="false" xsi:type="As">
                     <operand localId="530" locator="148:17-148:27" path="abatement" xsi:type="Property">
                        <source localId="529" locator="148:17" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="531" locator="148:32-148:41" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="537" locator="149:5-149:38" path="value" xsi:type="Property">
                  <source localId="533" locator="149:5-149:32" strict="false" xsi:type="As">
                     <operand localId="535" locator="149:6-149:16" path="abatement" xsi:type="Property">
                        <source localId="534" locator="149:6" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="536" locator="149:21-149:31" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </element>
            </operand>
         </expression>
         <operand localId="516" name="c">
            <operandTypeSpecifier localId="515" locator="143:29-143:42" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="545" locator="161:1-167:3" name="ConditionDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="545">
               <a:s>/*******************************************************************************
 * END: Code adapted from &quot;Factors to Consider in Managing Chronic Pain: A Pain 
 * Management Summary&quot;
*******************************************************************************/

/*******************************************************************************
* Condition Functions
*******************************************************************************/

define function ConditionDate(C Condition):
  </a:s>
               <a:s r="570">
                  <a:s r="570">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="552">
                        <a:s r="548">
                           <a:s>(</a:s>
                           <a:s r="548">
                              <a:s r="550">
                                 <a:s r="549">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="550">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="551">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="552">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="558">
                        <a:s r="557">
                           <a:s r="553">
                              <a:s>(</a:s>
                              <a:s r="553">
                                 <a:s r="555">
                                    <a:s r="554">
                                       <a:s>C</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="555">
                                       <a:s>onset</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="556">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="557">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="558">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="564">
                        <a:s r="563">
                           <a:s r="559">
                              <a:s>(</a:s>
                              <a:s r="559">
                                 <a:s r="561">
                                    <a:s r="560">
                                       <a:s>C</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="561">
                                       <a:s>onset</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="562">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="563">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="564">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="567">
                        <a:s r="566">
                           <a:s r="565">
                              <a:s>C</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="566">
                              <a:s>recordedDate</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="567">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="570" locator="162:3-167:3" xsi:type="Coalesce">
            <operand localId="552" locator="163:5-163:36" path="value" xsi:type="Property">
               <source localId="548" locator="163:5-163:30" strict="false" xsi:type="As">
                  <operand localId="550" locator="163:6-163:12" path="onset" xsi:type="Property">
                     <source localId="549" locator="163:6" name="C" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="551" locator="163:17-163:29" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="558" locator="164:5-164:40" path="value" xsi:type="Property">
               <source localId="557" locator="164:5-164:34" path="end" xsi:type="Property">
                  <source localId="553" locator="164:5-164:28" strict="false" xsi:type="As">
                     <operand localId="555" locator="164:6-164:12" path="onset" xsi:type="Property">
                        <source localId="554" locator="164:6" name="C" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="556" locator="164:17-164:27" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="564" locator="165:5-165:42" path="value" xsi:type="Property">
               <source localId="563" locator="165:5-165:36" path="start" xsi:type="Property">
                  <source localId="559" locator="165:5-165:28" strict="false" xsi:type="As">
                     <operand localId="561" locator="165:6-165:12" path="onset" xsi:type="Property">
                        <source localId="560" locator="165:6" name="C" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="562" locator="165:17-165:27" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="567" locator="166:5-166:24" path="value" xsi:type="Property">
               <source localId="566" locator="166:5-166:18" path="recordedDate" xsi:type="Property">
                  <source localId="565" locator="166:5" name="C" xsi:type="OperandRef"/>
               </source>
            </operand>
         </expression>
         <operand localId="547" name="C">
            <operandTypeSpecifier localId="546" locator="161:33-161:41" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="571" locator="176:1-182:3" name="OldestCondition" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="571">
               <a:s>/**
 * The oldest condition.  For each Condition, this algorithm will use the Coalesce function, which uses the
 * first non-null result from these fields: onsetDateTime, onsetPeriod.start, assertedDate, onsetPeriod.end.
 * The found date will be used to compare Conditions and determine the oldest one.
 * @param CondList - a list of Conditions
 * @returns {Condition} the oldest Condition from the list, or null if null was passed in
 */
define function OldestCondition(CondList List&lt;Condition>):
  </a:s>
               <a:s r="627">
                  <a:s r="627">
                     <a:s>First(</a:s>
                     <a:s r="622">
                        <a:s>
                           <a:s r="575">
                              <a:s r="576">
                                 <a:s>
                                    <a:s>CondList</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> C</a:s>
                           </a:s>
                        </a:s>
                        <a:s> </a:s>
                        <a:s r="616">
                           <a:s>sort by </a:s>
                           <a:s r="615">
                              <a:s r="614">
                                 <a:s>Coalesce(
    </a:s>
                                 <a:s r="599">
                                    <a:s r="596">
                                       <a:s>(</a:s>
                                       <a:s r="596">
                                          <a:s r="597">
                                             <a:s>onset</a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="598">
                                             <a:s>FHIR.dateTime</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="599">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="604">
                                    <a:s r="603">
                                       <a:s r="600">
                                          <a:s>(</a:s>
                                          <a:s r="600">
                                             <a:s r="601">
                                                <a:s>onset</a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="602">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="603">
                                          <a:s>&quot;start&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="604">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="606">
                                    <a:s r="605">
                                       <a:s>recordedDate</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="606">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="611">
                                    <a:s r="610">
                                       <a:s r="607">
                                          <a:s>(</a:s>
                                          <a:s r="607">
                                             <a:s r="608">
                                                <a:s>onset</a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="609">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="610">
                                          <a:s>&quot;end&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="611">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="627" locator="177:3-182:3" xsi:type="First">
            <signature localId="628" xsi:type="ListTypeSpecifier">
               <elementType localId="629" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <source localId="622" locator="177:9-181:39" xsi:type="Query">
               <source localId="575" locator="177:9-177:18" alias="C">
                  <expression localId="576" locator="177:9-177:16" name="CondList" xsi:type="OperandRef"/>
               </source>
               <sort localId="616" locator="177:20-181:39">
                  <by localId="615" locator="177:28-181:39" direction="asc" xsi:type="ByExpression">
                     <expression localId="614" locator="177:28-181:39" xsi:type="Coalesce">
                        <operand localId="599" locator="178:5-178:34" path="value" xsi:type="Property">
                           <source localId="596" locator="178:5-178:28" strict="false" xsi:type="As">
                              <operand localId="597" locator="178:6-178:10" name="onset" xsi:type="IdentifierRef"/>
                              <asTypeSpecifier localId="598" locator="178:15-178:27" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </operand>
                        <operand localId="604" locator="179:5-179:40" path="value" xsi:type="Property">
                           <source localId="603" locator="179:5-179:34" path="start" xsi:type="Property">
                              <source localId="600" locator="179:5-179:26" strict="false" xsi:type="As">
                                 <operand localId="601" locator="179:6-179:10" name="onset" xsi:type="IdentifierRef"/>
                                 <asTypeSpecifier localId="602" locator="179:15-179:25" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </source>
                        </operand>
                        <operand localId="606" locator="180:5-180:22" path="value" xsi:type="Property">
                           <source localId="605" locator="180:5-180:16" name="recordedDate" xsi:type="IdentifierRef"/>
                        </operand>
                        <operand localId="611" locator="181:5-181:38" path="value" xsi:type="Property">
                           <source localId="610" locator="181:5-181:32" path="end" xsi:type="Property">
                              <source localId="607" locator="181:5-181:26" strict="false" xsi:type="As">
                                 <operand localId="608" locator="181:6-181:10" name="onset" xsi:type="IdentifierRef"/>
                                 <asTypeSpecifier localId="609" locator="181:15-181:25" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </source>
                        </operand>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
         <operand localId="574" name="CondList">
            <operandTypeSpecifier localId="572" locator="176:42-176:56" xsi:type="ListTypeSpecifier">
               <elementType localId="573" locator="176:47-176:55" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="630" locator="192:1-197:3" name="DateOfFirstCondition" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="630">
               <a:s>/**
 * Date of the oldest condition in a list.  For each Condition, this algorithm will use the Coalesce function, which uses the
 * first non-null result from these fields: onsetDateTime, onsetPeriod.start, assertedDate, onsetPeriod.end.
 * The found date will be used to compare Conditions and determine the oldest one. The date of the oldest Condition
 * will be returned.
 * @param CondList - a list of Conditions
 * @returns {System.String} the text representation of the Condition's date
 */
define function DateOfFirstCondition(CondList List&lt;Condition>):
  </a:s>
               <a:s r="636">
                  <a:s r="636">
                     <a:s>ConditionDate(
    </a:s>
                     <a:s r="635">
                        <a:s>OldestCondition(
      </a:s>
                        <a:s r="634">
                           <a:s>CondList</a:s>
                        </a:s>
                        <a:s>
    )</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="636" locator="193:3-197:3" name="ConditionDate" xsi:type="FunctionRef">
            <operand localId="635" locator="194:5-196:5" name="OldestCondition" xsi:type="FunctionRef">
               <operand localId="634" locator="195:7-195:14" name="CondList" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand localId="633" name="CondList">
            <operandTypeSpecifier localId="631" locator="192:47-192:61" xsi:type="ListTypeSpecifier">
               <elementType localId="632" locator="192:52-192:60" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="637" locator="205:1-207:60" name="ValidCondition" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="637">
               <a:s>/**
 * Conditions that are valid. This is reflected by a Condition that does not have a verificationStatus of 'refuted' or `entered-in-error`.
 * @see http://hl7.org/fhir/R4/valueset-condition-ver-status.html
 * @param CondList - a list of Conditions
 * @returns {List&lt;Condition>} a list of valid Conditions, or null if null was passed in
 */
define function ValidCondition(CondList List&lt;Condition>):
  </a:s>
               <a:s r="660">
                  <a:s r="660">
                     <a:s>
                        <a:s r="641">
                           <a:s r="642">
                              <a:s>
                                 <a:s>CondList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> C</a:s>
                        </a:s>
                     </a:s>
                     <a:s> </a:s>
                     <a:s r="643">
                        <a:s>where </a:s>
                        <a:s r="643">
                           <a:s r="651">
                              <a:s r="646">
                                 <a:s r="645">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="646">
                                    <a:s>verificationStatus</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> !~ </a:s>
                              <a:s r="647">
                                 <a:s>&quot;Condition Refuted&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    and </a:s>
                           <a:s r="659">
                              <a:s r="654">
                                 <a:s r="653">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="654">
                                    <a:s>verificationStatus</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> !~ </a:s>
                              <a:s r="655">
                                 <a:s>&quot;Condition Entered in Error&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="660" locator="206:3-207:60" xsi:type="Query">
            <source localId="641" locator="206:3-206:12" alias="C">
               <expression localId="642" locator="206:3-206:10" name="CondList" xsi:type="OperandRef"/>
            </source>
            <where localId="643" locator="206:14-207:60" xsi:type="And">
               <operand localId="651" locator="206:20-206:62" xsi:type="Not">
                  <operand localId="644" locator="206:20-206:62" xsi:type="Equivalent">
                     <signature localId="649" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="650" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="648" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="646" locator="206:20-206:39" path="verificationStatus" scope="C" xsi:type="Property"/>
                     </operand>
                     <operand localId="647" locator="206:44-206:62" name="Condition Refuted" xsi:type="ConceptRef"/>
                  </operand>
               </operand>
               <operand localId="659" locator="207:9-207:60" xsi:type="Not">
                  <operand localId="652" locator="207:9-207:60" xsi:type="Equivalent">
                     <signature localId="657" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="658" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="656" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="654" locator="207:9-207:28" path="verificationStatus" scope="C" xsi:type="Property"/>
                     </operand>
                     <operand localId="655" locator="207:33-207:60" name="Condition Entered in Error" xsi:type="ConceptRef"/>
                  </operand>
               </operand>
            </where>
         </expression>
         <operand localId="640" name="CondList">
            <operandTypeSpecifier localId="638" locator="205:41-205:55" xsi:type="ListTypeSpecifier">
               <elementType localId="639" locator="205:46-205:54" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="661" locator="217:1-222:3" name="DiagnosticReportDateString" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="661">
               <a:s>/*******************************************************************************
* DiagnosticReport Functions
*******************************************************************************/

// Returns a text representation of a date associated with a DiagnosticReport, preferring `effectiveDateTime`, then
// `.start`.
// @param s - a FHIR DiagnosticReport to get the text date from
// @returns {System.String} the text representation of a relevant date from the DiagnosticReport
define function DiagnosticReportDateString(d FHIR.DiagnosticReport):
  </a:s>
               <a:s r="687">
                  <a:s r="687">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="671">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="664">
                           <a:s r="669">
                              <a:s r="665">
                                 <a:s>(</a:s>
                                 <a:s r="665">
                                    <a:s r="667">
                                       <a:s r="666">
                                          <a:s>d</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="667">
                                          <a:s>effective</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="668">
                                       <a:s>FHIR.Period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="669">
                                 <a:s>&quot;end&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="670">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="676">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="672">
                           <a:s r="674">
                              <a:s r="673">
                                 <a:s>d</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="674">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="675">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="684">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="677">
                           <a:s r="682">
                              <a:s r="678">
                                 <a:s>(</a:s>
                                 <a:s r="678">
                                    <a:s r="680">
                                       <a:s r="679">
                                          <a:s>d</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="680">
                                          <a:s>effective</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="681">
                                       <a:s>FHIR.Period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="682">
                                 <a:s>&quot;start&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="683">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="687" locator="218:3-222:3" xsi:type="Coalesce">
            <operand localId="671" locator="219:5-219:69" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="664" locator="219:18-219:68" strict="false" xsi:type="As">
                  <operand localId="669" locator="219:18-219:51" path="end" xsi:type="Property">
                     <source localId="665" locator="219:18-219:45" strict="false" xsi:type="As">
                        <operand localId="667" locator="219:19-219:29" path="effective" xsi:type="Property">
                           <source localId="666" locator="219:19" name="d" xsi:type="OperandRef"/>
                        </operand>
                        <asTypeSpecifier localId="668" locator="219:34-219:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </source>
                  </operand>
                  <asTypeSpecifier localId="670" locator="219:56-219:68" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="676" locator="220:5-220:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="672" locator="220:18-220:45" strict="false" xsi:type="As">
                  <operand localId="674" locator="220:18-220:28" path="effective" xsi:type="Property">
                     <source localId="673" locator="220:18" name="d" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="675" locator="220:33-220:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="684" locator="221:5-221:71" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="677" locator="221:18-221:70" strict="false" xsi:type="As">
                  <operand localId="682" locator="221:18-221:53" path="start" xsi:type="Property">
                     <source localId="678" locator="221:18-221:45" strict="false" xsi:type="As">
                        <operand localId="680" locator="221:19-221:29" path="effective" xsi:type="Property">
                           <source localId="679" locator="221:19" name="d" xsi:type="OperandRef"/>
                        </operand>
                        <asTypeSpecifier localId="681" locator="221:34-221:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </source>
                  </operand>
                  <asTypeSpecifier localId="683" locator="221:58-221:70" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
         </expression>
         <operand localId="663" name="d">
            <operandTypeSpecifier localId="662" locator="217:46-217:66" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="688" locator="224:1-229:3" name="DiagnosticReportDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="688">
               <a:s>define function DiagnosticReportDate(d FHIR.DiagnosticReport):
  </a:s>
               <a:s r="713">
                  <a:s r="713">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="696">
                        <a:s r="695">
                           <a:s r="691">
                              <a:s>(</a:s>
                              <a:s r="691">
                                 <a:s r="693">
                                    <a:s r="692">
                                       <a:s>d</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="693">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="694">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="695">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="696">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="701">
                        <a:s r="697">
                           <a:s>(</a:s>
                           <a:s r="697">
                              <a:s r="699">
                                 <a:s r="698">
                                    <a:s>d</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="699">
                                    <a:s>effective</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="700">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="701">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="707">
                        <a:s r="706">
                           <a:s r="702">
                              <a:s>(</a:s>
                              <a:s r="702">
                                 <a:s r="704">
                                    <a:s r="703">
                                       <a:s>d</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="704">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="705">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="706">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="707">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="713" locator="225:3-229:3" xsi:type="Coalesce">
            <signature localId="714" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <signature localId="715" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <signature localId="716" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <operand localId="696" locator="226:5-226:44" path="value" xsi:type="Property">
               <source localId="695" locator="226:5-226:38" path="end" xsi:type="Property">
                  <source localId="691" locator="226:5-226:32" strict="false" xsi:type="As">
                     <operand localId="693" locator="226:6-226:16" path="effective" xsi:type="Property">
                        <source localId="692" locator="226:6" name="d" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="694" locator="226:21-226:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="701" locator="227:5-227:40" path="value" xsi:type="Property">
               <source localId="697" locator="227:5-227:34" strict="false" xsi:type="As">
                  <operand localId="699" locator="227:6-227:16" path="effective" xsi:type="Property">
                     <source localId="698" locator="227:6" name="d" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="700" locator="227:21-227:33" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="707" locator="228:5-228:46" path="value" xsi:type="Property">
               <source localId="706" locator="228:5-228:40" path="start" xsi:type="Property">
                  <source localId="702" locator="228:5-228:32" strict="false" xsi:type="As">
                     <operand localId="704" locator="228:6-228:16" path="effective" xsi:type="Property">
                        <source localId="703" locator="228:6" name="d" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="705" locator="228:21-228:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
         </expression>
         <operand localId="690" name="d">
            <operandTypeSpecifier localId="689" locator="224:40-224:60" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="717" locator="231:1-236:3" name="SortedDiagnosticReports" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="717">
               <a:s>define function SortedDiagnosticReports(ReportList List&lt;FHIR.DiagnosticReport>):
  </a:s>
               <a:s r="770">
                  <a:s r="770">
                     <a:s>
                        <a:s r="721">
                           <a:s r="722">
                              <a:s>
                                 <a:s>ReportList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> R</a:s>
                        </a:s>
                     </a:s>
                     <a:s> </a:s>
                     <a:s r="764">
                        <a:s>sort by </a:s>
                        <a:s r="763">
                           <a:s r="759">
                              <a:s>Coalesce(
    </a:s>
                              <a:s r="744">
                                 <a:s r="743">
                                    <a:s r="740">
                                       <a:s>(</a:s>
                                       <a:s r="740">
                                          <a:s r="741">
                                             <a:s>effective</a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="742">
                                             <a:s>FHIR.Period</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="743">
                                       <a:s>&quot;end&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="744">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>,
    </a:s>
                              <a:s r="748">
                                 <a:s r="745">
                                    <a:s>(</a:s>
                                    <a:s r="745">
                                       <a:s r="746">
                                          <a:s>effective</a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="747">
                                          <a:s>FHIR.dateTime</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="748">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>,
    </a:s>
                              <a:s r="753">
                                 <a:s r="752">
                                    <a:s r="749">
                                       <a:s>(</a:s>
                                       <a:s r="749">
                                          <a:s r="750">
                                             <a:s>effective</a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="751">
                                             <a:s>FHIR.Period</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="752">
                                       <a:s>&quot;start&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="753">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  )</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="770" locator="232:3-236:3" xsi:type="Query">
            <source localId="721" locator="232:3-232:14" alias="R">
               <expression localId="722" locator="232:3-232:12" name="ReportList" xsi:type="OperandRef"/>
            </source>
            <sort localId="764" locator="232:16-236:3">
               <by localId="763" locator="232:24-236:3" direction="asc" xsi:type="ByExpression">
                  <expression localId="759" locator="232:24-236:3" xsi:type="Coalesce">
                     <signature localId="760" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="761" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="762" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="744" locator="233:5-233:42" path="value" xsi:type="Property">
                        <source localId="743" locator="233:5-233:36" path="end" xsi:type="Property">
                           <source localId="740" locator="233:5-233:30" strict="false" xsi:type="As">
                              <operand localId="741" locator="233:6-233:14" name="effective" xsi:type="IdentifierRef"/>
                              <asTypeSpecifier localId="742" locator="233:19-233:29" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </source>
                     </operand>
                     <operand localId="748" locator="234:5-234:38" path="value" xsi:type="Property">
                        <source localId="745" locator="234:5-234:32" strict="false" xsi:type="As">
                           <operand localId="746" locator="234:6-234:14" name="effective" xsi:type="IdentifierRef"/>
                           <asTypeSpecifier localId="747" locator="234:19-234:31" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </source>
                     </operand>
                     <operand localId="753" locator="235:5-235:44" path="value" xsi:type="Property">
                        <source localId="752" locator="235:5-235:38" path="start" xsi:type="Property">
                           <source localId="749" locator="235:5-235:30" strict="false" xsi:type="As">
                              <operand localId="750" locator="235:6-235:14" name="effective" xsi:type="IdentifierRef"/>
                              <asTypeSpecifier localId="751" locator="235:19-235:29" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </source>
                     </operand>
                  </expression>
               </by>
            </sort>
         </expression>
         <operand localId="720" name="ReportList">
            <operandTypeSpecifier localId="718" locator="231:52-231:78" xsi:type="ListTypeSpecifier">
               <elementType localId="719" locator="231:57-231:77" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="771" locator="238:1-243:3" name="MostRecentDiagnosticReport" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="771">
               <a:s>define function MostRecentDiagnosticReport(ReportList List&lt;FHIR.DiagnosticReport>):
  </a:s>
               <a:s r="779">
                  <a:s r="779">
                     <a:s>Last(
    </a:s>
                     <a:s r="776">
                        <a:s>SortedDiagnosticReports(
      </a:s>
                        <a:s r="775">
                           <a:s>ReportList</a:s>
                        </a:s>
                        <a:s>
    )</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="779" locator="239:3-243:3" xsi:type="Last">
            <source localId="776" locator="240:5-242:5" name="SortedDiagnosticReports" xsi:type="FunctionRef">
               <operand localId="775" locator="241:7-241:16" name="ReportList" xsi:type="OperandRef"/>
            </source>
         </expression>
         <operand localId="774" name="ReportList">
            <operandTypeSpecifier localId="772" locator="238:55-238:81" xsi:type="ListTypeSpecifier">
               <elementType localId="773" locator="238:60-238:80" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="780" locator="253:1-257:83" name="LookBack" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="780">
               <a:s>/**
* Diagnostic Reports that are issued in the specified &quot;look back&quot; period.
* TODO: Rename to LookBack once the execution engine supports overloaded functions.
* @param DiagnosticReportList - a list of DiagnosticReports
* @param LookBack - the lookback period for when the DiagnosticReport specimen was collected
* @returns {List&lt;DiagnosticReport>} a list of DiagnosticReports in the look back period, or null if null
* was passed in
*/
define function LookBack(DiagnosticReportList List&lt;DiagnosticReport>, LookBack System.Quantity):
  </a:s>
               <a:s r="816">
                  <a:s r="816">
                     <a:s>
                        <a:s r="786">
                           <a:s r="787">
                              <a:s>
                                 <a:s>DiagnosticReportList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> D</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="788">
                           <a:s>LookBackInterval: </a:s>
                           <a:s r="799">
                              <a:s>Interval[</a:s>
                              <a:s r="789">
                                 <a:s r="792">
                                    <a:s>Now()</a:s>
                                 </a:s>
                                 <a:s> - </a:s>
                                 <a:s r="793">
                                    <a:s>LookBack</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="798">
                                 <a:s>Now()</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="800">
                        <a:s>where </a:s>
                        <a:s r="800">
                           <a:s r="807">
                              <a:s r="805">
                                 <a:s r="801">
                                    <a:s>(</a:s>
                                    <a:s r="801">
                                       <a:s r="803">
                                          <a:s r="802">
                                             <a:s>D</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="803">
                                             <a:s>effective</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="804">
                                          <a:s>FHIR.dateTime</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="805">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> in </a:s>
                              <a:s r="806">
                                 <a:s>LookBackInterval</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="815">
                              <a:s r="813">
                                 <a:s r="808">
                                    <a:s>C3F</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="813">
                                    <a:s>PeriodToInterval(</a:s>
                                    <a:s r="809">
                                       <a:s r="811">
                                          <a:s r="810">
                                             <a:s>D</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="811">
                                             <a:s>effective</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="812">
                                          <a:s>FHIR.Period</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="815"> overlaps </a:s>
                              <a:s r="814">
                                 <a:s>LookBackInterval</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="816" locator="254:3-257:83" xsi:type="Query">
            <source localId="786" locator="254:3-254:24" alias="D">
               <expression localId="787" locator="254:3-254:22" name="DiagnosticReportList" xsi:type="OperandRef"/>
            </source>
            <let localId="788" locator="255:9-255:59" identifier="LookBackInterval">
               <expression localId="799" locator="255:27-255:59" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <low localId="789" locator="255:36-255:51" xsi:type="Subtract">
                     <signature localId="794" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="795" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="792" locator="255:36-255:40" xsi:type="Now"/>
                     <operand localId="793" locator="255:44-255:51" name="LookBack" xsi:type="OperandRef"/>
                  </low>
                  <high localId="798" locator="255:54-255:58" xsi:type="Now"/>
               </expression>
            </let>
            <where localId="800" locator="256:5-257:83" xsi:type="Or">
               <operand localId="807" locator="256:11-256:66" xsi:type="In">
                  <operand localId="805" locator="256:11-256:46" path="value" xsi:type="Property">
                     <source localId="801" locator="256:11-256:40" strict="false" xsi:type="As">
                        <operand localId="803" locator="256:12-256:22" path="effective" scope="D" xsi:type="Property"/>
                        <asTypeSpecifier localId="804" locator="256:27-256:39" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </source>
                  </operand>
                  <operand localId="806" locator="256:51-256:66" name="LookBackInterval" xsi:type="QueryLetRef"/>
               </operand>
               <operand localId="815" locator="257:10-257:83" xsi:type="Overlaps">
                  <operand localId="813" locator="257:10-257:57" name="PeriodToInterval" libraryName="C3F" xsi:type="FunctionRef">
                     <operand localId="809" locator="257:31-257:56" strict="false" xsi:type="As">
                        <operand localId="811" locator="257:31-257:41" path="effective" scope="D" xsi:type="Property"/>
                        <asTypeSpecifier localId="812" locator="257:46-257:56" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </operand>
                  <operand localId="814" locator="257:68-257:83" name="LookBackInterval" xsi:type="QueryLetRef"/>
               </operand>
            </where>
         </expression>
         <operand localId="783" name="DiagnosticReportList">
            <operandTypeSpecifier localId="781" locator="253:47-253:68" xsi:type="ListTypeSpecifier">
               <elementType localId="782" locator="253:52-253:67" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
         <operand localId="785" name="LookBack">
            <operandTypeSpecifier localId="784" locator="253:80-253:94" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="817" locator="267:1-271:170" name="LookBack" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="817">
               <a:s>/**
* Diagnostic Reports that are issued in the specified &quot;look back&quot; period and after a specified &quot;look back&quot; date
* @param DiagnosticReportList - a list of DiagnosticReports
* @param LookBack - the lookback period for when the DiagnosticReport specimen was collected
* @param LookBackDate - the date that the DiagnosticReport test must fall after
* @returns {List&lt;DiagnosticReport>} a list of DiagnosticReports in the look back period and after the
* look back date, or null if null was passed in
*/
define function LookBack(DiagnosticReportList List&lt;DiagnosticReport>, LookBack System.Quantity, LookBackDate System.DateTime):
  </a:s>
               <a:s r="877">
                  <a:s r="877">
                     <a:s>
                        <a:s r="825">
                           <a:s r="826">
                              <a:s>
                                 <a:s>DiagnosticReportList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> D</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="827">
                           <a:s>LookBackInterval: </a:s>
                           <a:s r="838">
                              <a:s>Interval[</a:s>
                              <a:s r="828">
                                 <a:s r="831">
                                    <a:s>Now()</a:s>
                                 </a:s>
                                 <a:s> - </a:s>
                                 <a:s r="832">
                                    <a:s>LookBack</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="837">
                                 <a:s>Now()</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="839">
                        <a:s>where </a:s>
                        <a:s r="839">
                           <a:s r="840">
                              <a:s>( </a:s>
                              <a:s r="840">
                                 <a:s r="847">
                                    <a:s>(</a:s>
                                    <a:s r="847">
                                       <a:s r="845">
                                          <a:s r="841">
                                             <a:s>(</a:s>
                                             <a:s r="841">
                                                <a:s r="843">
                                                   <a:s r="842">
                                                      <a:s>D</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="843">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="844">
                                                   <a:s>FHIR.dateTime</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="845">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> in </a:s>
                                       <a:s r="846">
                                          <a:s>LookBackInterval</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> and </a:s>
                                 <a:s r="854">
                                    <a:s>(</a:s>
                                    <a:s r="854">
                                       <a:s r="852">
                                          <a:s r="848">
                                             <a:s>(</a:s>
                                             <a:s r="848">
                                                <a:s r="850">
                                                   <a:s r="849">
                                                      <a:s>D</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="850">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="851">
                                                   <a:s>FHIR.dateTime</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="852">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s r="854"> after </a:s>
                                       <a:s r="853">
                                          <a:s>LookBackDate</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> )</a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="857">
                              <a:s>( </a:s>
                              <a:s r="857">
                                 <a:s r="865">
                                    <a:s>(</a:s>
                                    <a:s r="865">
                                       <a:s r="863">
                                          <a:s r="858">
                                             <a:s>C3F</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="863">
                                             <a:s>PeriodToInterval(</a:s>
                                             <a:s r="859">
                                                <a:s r="861">
                                                   <a:s r="860">
                                                      <a:s>D</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="861">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="862">
                                                   <a:s>FHIR.Period</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s r="865"> overlaps </a:s>
                                       <a:s r="864">
                                          <a:s>LookBackInterval</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> and </a:s>
                                 <a:s r="874">
                                    <a:s>(</a:s>
                                    <a:s r="874">
                                       <a:s r="871">
                                          <a:s r="866">
                                             <a:s>C3F</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="871">
                                             <a:s>PeriodToInterval(</a:s>
                                             <a:s r="867">
                                                <a:s r="869">
                                                   <a:s r="868">
                                                      <a:s>D</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="869">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="870">
                                                   <a:s>FHIR.Period</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s r="874"> starts after </a:s>
                                       <a:s r="872">
                                          <a:s>LookBackDate</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> )</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="877" locator="268:3-271:170" xsi:type="Query">
            <source localId="825" locator="268:3-268:24" alias="D">
               <expression localId="826" locator="268:3-268:22" name="DiagnosticReportList" xsi:type="OperandRef"/>
            </source>
            <let localId="827" locator="269:9-269:59" identifier="LookBackInterval">
               <expression localId="838" locator="269:27-269:59" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <low localId="828" locator="269:36-269:51" xsi:type="Subtract">
                     <signature localId="833" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="834" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="831" locator="269:36-269:40" xsi:type="Now"/>
                     <operand localId="832" locator="269:44-269:51" name="LookBack" xsi:type="OperandRef"/>
                  </low>
                  <high localId="837" locator="269:54-269:58" xsi:type="Now"/>
               </expression>
            </let>
            <where localId="839" locator="270:5-271:170" xsi:type="Or">
               <operand localId="840" locator="270:11-270:134" xsi:type="And">
                  <operand localId="847" locator="270:13-270:70" xsi:type="In">
                     <operand localId="845" locator="270:14-270:49" path="value" xsi:type="Property">
                        <source localId="841" locator="270:14-270:43" strict="false" xsi:type="As">
                           <operand localId="843" locator="270:15-270:25" path="effective" scope="D" xsi:type="Property"/>
                           <asTypeSpecifier localId="844" locator="270:30-270:42" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </source>
                     </operand>
                     <operand localId="846" locator="270:54-270:69" name="LookBackInterval" xsi:type="QueryLetRef"/>
                  </operand>
                  <operand localId="854" locator="270:76-270:132" xsi:type="After">
                     <signature localId="855" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="856" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="852" locator="270:77-270:112" path="value" xsi:type="Property">
                        <source localId="848" locator="270:77-270:106" strict="false" xsi:type="As">
                           <operand localId="850" locator="270:78-270:88" path="effective" scope="D" xsi:type="Property"/>
                           <asTypeSpecifier localId="851" locator="270:93-270:105" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </source>
                     </operand>
                     <operand localId="853" locator="270:120-270:131" name="LookBackDate" xsi:type="OperandRef"/>
                  </operand>
               </operand>
               <operand localId="857" locator="271:10-271:170" xsi:type="And">
                  <operand localId="865" locator="271:12-271:87" xsi:type="Overlaps">
                     <operand localId="863" locator="271:13-271:60" name="PeriodToInterval" libraryName="C3F" xsi:type="FunctionRef">
                        <operand localId="859" locator="271:34-271:59" strict="false" xsi:type="As">
                           <operand localId="861" locator="271:34-271:44" path="effective" scope="D" xsi:type="Property"/>
                           <asTypeSpecifier localId="862" locator="271:49-271:59" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        </operand>
                     </operand>
                     <operand localId="864" locator="271:71-271:86" name="LookBackInterval" xsi:type="QueryLetRef"/>
                  </operand>
                  <operand localId="874" locator="271:93-271:168" xsi:type="After">
                     <signature localId="875" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="876" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="873" locator="271:143-271:148" xsi:type="Start">
                        <operand localId="871" locator="271:94-271:141" name="PeriodToInterval" libraryName="C3F" xsi:type="FunctionRef">
                           <operand localId="867" locator="271:115-271:140" strict="false" xsi:type="As">
                              <operand localId="869" locator="271:115-271:125" path="effective" scope="D" xsi:type="Property"/>
                              <asTypeSpecifier localId="870" locator="271:130-271:140" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="872" locator="271:156-271:167" name="LookBackDate" xsi:type="OperandRef"/>
                  </operand>
               </operand>
            </where>
         </expression>
         <operand localId="820" name="DiagnosticReportList">
            <operandTypeSpecifier localId="818" locator="267:47-267:68" xsi:type="ListTypeSpecifier">
               <elementType localId="819" locator="267:52-267:67" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
         <operand localId="822" name="LookBack">
            <operandTypeSpecifier localId="821" locator="267:80-267:94" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand localId="824" name="LookBackDate">
            <operandTypeSpecifier localId="823" locator="267:110-267:124" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="878" locator="274:1-285:9" name="AssociateDiagnosticReports" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="878">
               <a:s>// TODO: Parameterize by association window (currently hard-coded to 1 day)
define function AssociateDiagnosticReports(d1 FHIR.DiagnosticReport, d2 FHIR.DiagnosticReport):
  </a:s>
               <a:s r="883">
                  <a:s r="883">
                     <a:s>if </a:s>
                     <a:s r="884">
                        <a:s>(
    </a:s>
                        <a:s r="884">
                           <a:s r="885">
                              <a:s r="886">
                                 <a:s r="887">
                                    <a:s r="888">
                                       <a:s r="910">
                                          <a:s r="893">
                                             <a:s r="889">
                                                <a:s>(</a:s>
                                                <a:s r="889">
                                                   <a:s r="891">
                                                      <a:s r="890">
                                                         <a:s>d1</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="891">
                                                         <a:s>effective</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s> as </a:s>
                                                   <a:s r="892">
                                                      <a:s>FHIR.dateTime</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="893">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="910">
                                             <a:s>within </a:s>
                                             <a:s r="899">
                                                <a:s>1 day</a:s>
                                             </a:s>
                                             <a:s> of</a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="898">
                                             <a:s r="894">
                                                <a:s>(</a:s>
                                                <a:s r="894">
                                                   <a:s r="896">
                                                      <a:s r="895">
                                                         <a:s>d2</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="896">
                                                         <a:s>effective</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s> as </a:s>
                                                   <a:s r="897">
                                                      <a:s>FHIR.dateTime</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="898">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> or
    </a:s>
                                       <a:s r="933">
                                          <a:s r="915">
                                             <a:s r="911">
                                                <a:s>(</a:s>
                                                <a:s r="911">
                                                   <a:s r="913">
                                                      <a:s r="912">
                                                         <a:s>d1</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="913">
                                                         <a:s>effective</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s> as </a:s>
                                                   <a:s r="914">
                                                      <a:s>FHIR.dateTime</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="915">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="933">
                                             <a:s>within </a:s>
                                             <a:s r="922">
                                                <a:s>1 day</a:s>
                                             </a:s>
                                             <a:s> of</a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="921">
                                             <a:s r="920">
                                                <a:s r="916">
                                                   <a:s>(</a:s>
                                                   <a:s r="916">
                                                      <a:s r="918">
                                                         <a:s r="917">
                                                            <a:s>d2</a:s>
                                                         </a:s>
                                                         <a:s>.</a:s>
                                                         <a:s r="918">
                                                            <a:s>effective</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s> as </a:s>
                                                      <a:s r="919">
                                                         <a:s>FHIR.Period</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s>)</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="920">
                                                   <a:s>&quot;start&quot;</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="921">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> or 
    </a:s>
                                    <a:s r="956">
                                       <a:s r="938">
                                          <a:s r="934">
                                             <a:s>(</a:s>
                                             <a:s r="934">
                                                <a:s r="936">
                                                   <a:s r="935">
                                                      <a:s>d1</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="936">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="937">
                                                   <a:s>FHIR.dateTime</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="938">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="956">
                                          <a:s>within </a:s>
                                          <a:s r="945">
                                             <a:s>1 day</a:s>
                                          </a:s>
                                          <a:s> of</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="944">
                                          <a:s r="943">
                                             <a:s r="939">
                                                <a:s>(</a:s>
                                                <a:s r="939">
                                                   <a:s r="941">
                                                      <a:s r="940">
                                                         <a:s>d2</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="941">
                                                         <a:s>effective</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s> as </a:s>
                                                   <a:s r="942">
                                                      <a:s>FHIR.Period</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="943">
                                                <a:s>&quot;end&quot;</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="944">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> or
    </a:s>
                                 <a:s r="979">
                                    <a:s r="961">
                                       <a:s r="957">
                                          <a:s>(</a:s>
                                          <a:s r="957">
                                             <a:s r="959">
                                                <a:s r="958">
                                                   <a:s>d2</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="959">
                                                   <a:s>effective</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="960">
                                                <a:s>FHIR.dateTime</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="961">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> </a:s>
                                    <a:s r="979">
                                       <a:s>within </a:s>
                                       <a:s r="968">
                                          <a:s>1 day</a:s>
                                       </a:s>
                                       <a:s> of</a:s>
                                    </a:s>
                                    <a:s> </a:s>
                                    <a:s r="967">
                                       <a:s r="966">
                                          <a:s r="962">
                                             <a:s>(</a:s>
                                             <a:s r="962">
                                                <a:s r="964">
                                                   <a:s r="963">
                                                      <a:s>d1</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="964">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="965">
                                                   <a:s>FHIR.Period</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="966">
                                             <a:s>&quot;start&quot;</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="967">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s> or 
    </a:s>
                              <a:s r="1002">
                                 <a:s r="984">
                                    <a:s r="980">
                                       <a:s>(</a:s>
                                       <a:s r="980">
                                          <a:s r="982">
                                             <a:s r="981">
                                                <a:s>d2</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="982">
                                                <a:s>effective</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="983">
                                             <a:s>FHIR.dateTime</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="984">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="1002">
                                    <a:s>within </a:s>
                                    <a:s r="991">
                                       <a:s>1 day</a:s>
                                    </a:s>
                                    <a:s> of</a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="990">
                                    <a:s r="989">
                                       <a:s r="985">
                                          <a:s>(</a:s>
                                          <a:s r="985">
                                             <a:s r="987">
                                                <a:s r="986">
                                                   <a:s>d1</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="987">
                                                   <a:s>effective</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="988">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="989">
                                          <a:s>&quot;end&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="990">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s> or
    </a:s>
                           <a:s r="1011">
                              <a:s r="1003">
                                 <a:s>(</a:s>
                                 <a:s r="1003">
                                    <a:s r="1005">
                                       <a:s r="1004">
                                          <a:s>d1</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1005">
                                          <a:s>effective</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="1006">
                                       <a:s>FHIR.Period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s r="1011"> overlaps </a:s>
                              <a:s r="1007">
                                 <a:s>(</a:s>
                                 <a:s r="1007">
                                    <a:s r="1009">
                                       <a:s r="1008">
                                          <a:s>d2</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1009">
                                          <a:s>effective</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="1010">
                                       <a:s>FHIR.Period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                     <a:s r="1016"> then
    true
  else
    false</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="883" locator="275:3-285:9" xsi:type="If">
            <condition localId="884" locator="275:6-282:3" xsi:type="Or">
               <operand localId="885" locator="276:5-280:99" xsi:type="Or">
                  <operand localId="886" locator="276:5-279:101" xsi:type="Or">
                     <operand localId="887" locator="276:5-278:99" xsi:type="Or">
                        <operand localId="888" locator="276:5-277:101" xsi:type="Or">
                           <operand localId="910" locator="276:5-276:95" xsi:type="And">
                              <operand localId="907" xsi:type="In">
                                 <operand localId="893" locator="276:5-276:41" path="value" xsi:type="Property">
                                    <source localId="889" locator="276:5-276:35" strict="false" xsi:type="As">
                                       <operand localId="891" locator="276:6-276:17" path="effective" xsi:type="Property">
                                          <source localId="890" locator="276:6-276:7" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="892" locator="276:22-276:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </operand>
                                 <operand localId="906" locator="276:50-276:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low localId="900" locator="276:50-276:54" xsi:type="Subtract">
                                       <signature localId="901" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       <signature localId="902" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="898" locator="276:59-276:95" path="value" xsi:type="Property">
                                          <source localId="894" locator="276:59-276:89" strict="false" xsi:type="As">
                                             <operand localId="896" locator="276:60-276:71" path="effective" xsi:type="Property">
                                                <source localId="895" locator="276:60-276:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="897" locator="276:76-276:88" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </operand>
                                       <operand localId="899" locator="276:50-276:54" value="1" unit="day" xsi:type="Quantity"/>
                                    </low>
                                    <high localId="903" locator="276:50-276:54" xsi:type="Add">
                                       <signature localId="904" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       <signature localId="905" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="898" locator="276:59-276:95" path="value" xsi:type="Property">
                                          <source localId="894" locator="276:59-276:89" strict="false" xsi:type="As">
                                             <operand localId="896" locator="276:60-276:71" path="effective" xsi:type="Property">
                                                <source localId="895" locator="276:60-276:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="897" locator="276:76-276:88" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </operand>
                                       <operand localId="899" locator="276:50-276:54" value="1" unit="day" xsi:type="Quantity"/>
                                    </high>
                                 </operand>
                              </operand>
                              <operand localId="909" locator="276:50-276:54" xsi:type="Not">
                                 <operand localId="908" locator="276:50-276:54" xsi:type="IsNull">
                                    <operand localId="898" locator="276:59-276:95" path="value" xsi:type="Property">
                                       <source localId="894" locator="276:59-276:89" strict="false" xsi:type="As">
                                          <operand localId="896" locator="276:60-276:71" path="effective" xsi:type="Property">
                                             <source localId="895" locator="276:60-276:61" name="d2" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="897" locator="276:76-276:88" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </operand>
                                 </operand>
                              </operand>
                           </operand>
                           <operand localId="933" locator="277:5-277:101" xsi:type="And">
                              <operand localId="930" xsi:type="In">
                                 <operand localId="915" locator="277:5-277:41" path="value" xsi:type="Property">
                                    <source localId="911" locator="277:5-277:35" strict="false" xsi:type="As">
                                       <operand localId="913" locator="277:6-277:17" path="effective" xsi:type="Property">
                                          <source localId="912" locator="277:6-277:7" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="914" locator="277:22-277:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </operand>
                                 <operand localId="929" locator="277:50-277:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low localId="923" locator="277:50-277:54" xsi:type="Subtract">
                                       <signature localId="924" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       <signature localId="925" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="921" locator="277:59-277:101" path="value" xsi:type="Property">
                                          <source localId="920" locator="277:59-277:95" path="start" xsi:type="Property">
                                             <source localId="916" locator="277:59-277:87" strict="false" xsi:type="As">
                                                <operand localId="918" locator="277:60-277:71" path="effective" xsi:type="Property">
                                                   <source localId="917" locator="277:60-277:61" name="d2" xsi:type="OperandRef"/>
                                                </operand>
                                                <asTypeSpecifier localId="919" locator="277:76-277:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             </source>
                                          </source>
                                       </operand>
                                       <operand localId="922" locator="277:50-277:54" value="1" unit="day" xsi:type="Quantity"/>
                                    </low>
                                    <high localId="926" locator="277:50-277:54" xsi:type="Add">
                                       <signature localId="927" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       <signature localId="928" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="921" locator="277:59-277:101" path="value" xsi:type="Property">
                                          <source localId="920" locator="277:59-277:95" path="start" xsi:type="Property">
                                             <source localId="916" locator="277:59-277:87" strict="false" xsi:type="As">
                                                <operand localId="918" locator="277:60-277:71" path="effective" xsi:type="Property">
                                                   <source localId="917" locator="277:60-277:61" name="d2" xsi:type="OperandRef"/>
                                                </operand>
                                                <asTypeSpecifier localId="919" locator="277:76-277:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             </source>
                                          </source>
                                       </operand>
                                       <operand localId="922" locator="277:50-277:54" value="1" unit="day" xsi:type="Quantity"/>
                                    </high>
                                 </operand>
                              </operand>
                              <operand localId="932" locator="277:50-277:54" xsi:type="Not">
                                 <operand localId="931" locator="277:50-277:54" xsi:type="IsNull">
                                    <operand localId="921" locator="277:59-277:101" path="value" xsi:type="Property">
                                       <source localId="920" locator="277:59-277:95" path="start" xsi:type="Property">
                                          <source localId="916" locator="277:59-277:87" strict="false" xsi:type="As">
                                             <operand localId="918" locator="277:60-277:71" path="effective" xsi:type="Property">
                                                <source localId="917" locator="277:60-277:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="919" locator="277:76-277:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </source>
                                    </operand>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="956" locator="278:5-278:99" xsi:type="And">
                           <operand localId="953" xsi:type="In">
                              <operand localId="938" locator="278:5-278:41" path="value" xsi:type="Property">
                                 <source localId="934" locator="278:5-278:35" strict="false" xsi:type="As">
                                    <operand localId="936" locator="278:6-278:17" path="effective" xsi:type="Property">
                                       <source localId="935" locator="278:6-278:7" name="d1" xsi:type="OperandRef"/>
                                    </operand>
                                    <asTypeSpecifier localId="937" locator="278:22-278:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                 </source>
                              </operand>
                              <operand localId="952" locator="278:50-278:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low localId="946" locator="278:50-278:54" xsi:type="Subtract">
                                    <signature localId="947" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    <signature localId="948" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="944" locator="278:59-278:99" path="value" xsi:type="Property">
                                       <source localId="943" locator="278:59-278:93" path="end" xsi:type="Property">
                                          <source localId="939" locator="278:59-278:87" strict="false" xsi:type="As">
                                             <operand localId="941" locator="278:60-278:71" path="effective" xsi:type="Property">
                                                <source localId="940" locator="278:60-278:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="942" locator="278:76-278:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </source>
                                    </operand>
                                    <operand localId="945" locator="278:50-278:54" value="1" unit="day" xsi:type="Quantity"/>
                                 </low>
                                 <high localId="949" locator="278:50-278:54" xsi:type="Add">
                                    <signature localId="950" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    <signature localId="951" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="944" locator="278:59-278:99" path="value" xsi:type="Property">
                                       <source localId="943" locator="278:59-278:93" path="end" xsi:type="Property">
                                          <source localId="939" locator="278:59-278:87" strict="false" xsi:type="As">
                                             <operand localId="941" locator="278:60-278:71" path="effective" xsi:type="Property">
                                                <source localId="940" locator="278:60-278:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="942" locator="278:76-278:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </source>
                                    </operand>
                                    <operand localId="945" locator="278:50-278:54" value="1" unit="day" xsi:type="Quantity"/>
                                 </high>
                              </operand>
                           </operand>
                           <operand localId="955" locator="278:50-278:54" xsi:type="Not">
                              <operand localId="954" locator="278:50-278:54" xsi:type="IsNull">
                                 <operand localId="944" locator="278:59-278:99" path="value" xsi:type="Property">
                                    <source localId="943" locator="278:59-278:93" path="end" xsi:type="Property">
                                       <source localId="939" locator="278:59-278:87" strict="false" xsi:type="As">
                                          <operand localId="941" locator="278:60-278:71" path="effective" xsi:type="Property">
                                             <source localId="940" locator="278:60-278:61" name="d2" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="942" locator="278:76-278:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </source>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="979" locator="279:5-279:101" xsi:type="And">
                        <operand localId="976" xsi:type="In">
                           <operand localId="961" locator="279:5-279:41" path="value" xsi:type="Property">
                              <source localId="957" locator="279:5-279:35" strict="false" xsi:type="As">
                                 <operand localId="959" locator="279:6-279:17" path="effective" xsi:type="Property">
                                    <source localId="958" locator="279:6-279:7" name="d2" xsi:type="OperandRef"/>
                                 </operand>
                                 <asTypeSpecifier localId="960" locator="279:22-279:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </operand>
                           <operand localId="975" locator="279:50-279:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low localId="969" locator="279:50-279:54" xsi:type="Subtract">
                                 <signature localId="970" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 <signature localId="971" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="967" locator="279:59-279:101" path="value" xsi:type="Property">
                                    <source localId="966" locator="279:59-279:95" path="start" xsi:type="Property">
                                       <source localId="962" locator="279:59-279:87" strict="false" xsi:type="As">
                                          <operand localId="964" locator="279:60-279:71" path="effective" xsi:type="Property">
                                             <source localId="963" locator="279:60-279:61" name="d1" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="965" locator="279:76-279:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </source>
                                 </operand>
                                 <operand localId="968" locator="279:50-279:54" value="1" unit="day" xsi:type="Quantity"/>
                              </low>
                              <high localId="972" locator="279:50-279:54" xsi:type="Add">
                                 <signature localId="973" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 <signature localId="974" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="967" locator="279:59-279:101" path="value" xsi:type="Property">
                                    <source localId="966" locator="279:59-279:95" path="start" xsi:type="Property">
                                       <source localId="962" locator="279:59-279:87" strict="false" xsi:type="As">
                                          <operand localId="964" locator="279:60-279:71" path="effective" xsi:type="Property">
                                             <source localId="963" locator="279:60-279:61" name="d1" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="965" locator="279:76-279:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </source>
                                 </operand>
                                 <operand localId="968" locator="279:50-279:54" value="1" unit="day" xsi:type="Quantity"/>
                              </high>
                           </operand>
                        </operand>
                        <operand localId="978" locator="279:50-279:54" xsi:type="Not">
                           <operand localId="977" locator="279:50-279:54" xsi:type="IsNull">
                              <operand localId="967" locator="279:59-279:101" path="value" xsi:type="Property">
                                 <source localId="966" locator="279:59-279:95" path="start" xsi:type="Property">
                                    <source localId="962" locator="279:59-279:87" strict="false" xsi:type="As">
                                       <operand localId="964" locator="279:60-279:71" path="effective" xsi:type="Property">
                                          <source localId="963" locator="279:60-279:61" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="965" locator="279:76-279:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </source>
                              </operand>
                           </operand>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="1002" locator="280:5-280:99" xsi:type="And">
                     <operand localId="999" xsi:type="In">
                        <operand localId="984" locator="280:5-280:41" path="value" xsi:type="Property">
                           <source localId="980" locator="280:5-280:35" strict="false" xsi:type="As">
                              <operand localId="982" locator="280:6-280:17" path="effective" xsi:type="Property">
                                 <source localId="981" locator="280:6-280:7" name="d2" xsi:type="OperandRef"/>
                              </operand>
                              <asTypeSpecifier localId="983" locator="280:22-280:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </operand>
                        <operand localId="998" locator="280:50-280:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                           <low localId="992" locator="280:50-280:54" xsi:type="Subtract">
                              <signature localId="993" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="994" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="990" locator="280:59-280:99" path="value" xsi:type="Property">
                                 <source localId="989" locator="280:59-280:93" path="end" xsi:type="Property">
                                    <source localId="985" locator="280:59-280:87" strict="false" xsi:type="As">
                                       <operand localId="987" locator="280:60-280:71" path="effective" xsi:type="Property">
                                          <source localId="986" locator="280:60-280:61" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="988" locator="280:76-280:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </source>
                              </operand>
                              <operand localId="991" locator="280:50-280:54" value="1" unit="day" xsi:type="Quantity"/>
                           </low>
                           <high localId="995" locator="280:50-280:54" xsi:type="Add">
                              <signature localId="996" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="997" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="990" locator="280:59-280:99" path="value" xsi:type="Property">
                                 <source localId="989" locator="280:59-280:93" path="end" xsi:type="Property">
                                    <source localId="985" locator="280:59-280:87" strict="false" xsi:type="As">
                                       <operand localId="987" locator="280:60-280:71" path="effective" xsi:type="Property">
                                          <source localId="986" locator="280:60-280:61" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="988" locator="280:76-280:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </source>
                              </operand>
                              <operand localId="991" locator="280:50-280:54" value="1" unit="day" xsi:type="Quantity"/>
                           </high>
                        </operand>
                     </operand>
                     <operand localId="1001" locator="280:50-280:54" xsi:type="Not">
                        <operand localId="1000" locator="280:50-280:54" xsi:type="IsNull">
                           <operand localId="990" locator="280:59-280:99" path="value" xsi:type="Property">
                              <source localId="989" locator="280:59-280:93" path="end" xsi:type="Property">
                                 <source localId="985" locator="280:59-280:87" strict="false" xsi:type="As">
                                    <operand localId="987" locator="280:60-280:71" path="effective" xsi:type="Property">
                                       <source localId="986" locator="280:60-280:61" name="d1" xsi:type="OperandRef"/>
                                    </operand>
                                    <asTypeSpecifier localId="988" locator="280:76-280:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 </source>
                              </source>
                           </operand>
                        </operand>
                     </operand>
                  </operand>
               </operand>
               <operand localId="1011" locator="281:5-281:72" xsi:type="Overlaps">
                  <operand localId="1012" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature localId="1013" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1003" locator="281:5-281:33" strict="false" xsi:type="As">
                        <operand localId="1005" locator="281:6-281:17" path="effective" xsi:type="Property">
                           <source localId="1004" locator="281:6-281:7" name="d1" xsi:type="OperandRef"/>
                        </operand>
                        <asTypeSpecifier localId="1006" locator="281:22-281:32" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </operand>
                  <operand localId="1014" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature localId="1015" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1007" locator="281:44-281:72" strict="false" xsi:type="As">
                        <operand localId="1009" locator="281:45-281:56" path="effective" xsi:type="Property">
                           <source localId="1008" locator="281:45-281:46" name="d2" xsi:type="OperandRef"/>
                        </operand>
                        <asTypeSpecifier localId="1010" locator="281:61-281:71" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </operand>
               </operand>
            </condition>
            <then localId="1016" locator="283:5-283:8" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            <else localId="1017" locator="285:5-285:9" valueType="t:Boolean" value="false" xsi:type="Literal"/>
         </expression>
         <operand localId="880" name="d1">
            <operandTypeSpecifier localId="879" locator="274:47-274:67" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand localId="882" name="d2">
            <operandTypeSpecifier localId="881" locator="274:73-274:93" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1018" locator="287:1-298:9" name="CoincidentDiagnosticReports" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1018">
               <a:s>define function CoincidentDiagnosticReports(d1 FHIR.DiagnosticReport, d2 FHIR.DiagnosticReport):
  </a:s>
               <a:s r="1023">
                  <a:s r="1023">
                     <a:s>if </a:s>
                     <a:s r="1024">
                        <a:s>(
    </a:s>
                        <a:s r="1024">
                           <a:s r="1025">
                              <a:s r="1028">
                                 <a:s>AssociateDiagnosticReports(</a:s>
                                 <a:s r="1026">
                                    <a:s>d1</a:s>
                                 </a:s>
                                 <a:s>, </a:s>
                                 <a:s r="1027">
                                    <a:s>d2</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> or
    </a:s>
                              <a:s r="1029">
                                 <a:s r="1031">
                                    <a:s r="1030">
                                       <a:s>d1</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1031">
                                       <a:s>encounter</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="1033">
                                    <a:s r="1032">
                                       <a:s>d2</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1033">
                                       <a:s>encounter</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s> or
    </a:s>
                           <a:s r="1036">
                              <a:s>(
      </a:s>
                              <a:s r="1036">
                                 <a:s r="1056">
                                    <a:s>Coalesce(</a:s>
                                    <a:s r="1051">
                                       <a:s>
                                          <a:s r="1037">
                                             <a:s r="1039">
                                                <a:s>(</a:s>
                                                <a:s r="1039">
                                                   <a:s r="1038">
                                                      <a:s>d1</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="1039">
                                                      <a:s>basedOn</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s> R</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="1040">
                                          <a:s>where </a:s>
                                          <a:s r="1040">
                                             <a:s r="1042">
                                                <a:s r="1041">
                                                   <a:s>R</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="1042">
                                                   <a:s>type</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> = </a:s>
                                             <a:s r="1043">
                                                <a:s>'ServiceRequest'</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="1048">
                                          <a:s>return </a:s>
                                          <a:s r="1050">
                                             <a:s r="1049">
                                                <a:s>R</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1050">
                                                <a:s>reference</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> =
      </a:s>
                                 <a:s r="1078">
                                    <a:s>Coalesce(</a:s>
                                    <a:s r="1073">
                                       <a:s>
                                          <a:s r="1059">
                                             <a:s r="1061">
                                                <a:s>(</a:s>
                                                <a:s r="1061">
                                                   <a:s r="1060">
                                                      <a:s>d2</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="1061">
                                                      <a:s>basedOn</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s> R</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="1062">
                                          <a:s>where </a:s>
                                          <a:s r="1062">
                                             <a:s r="1064">
                                                <a:s r="1063">
                                                   <a:s>R</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="1064">
                                                   <a:s>type</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> = </a:s>
                                             <a:s r="1065">
                                                <a:s>'ServiceRequest'</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="1070">
                                          <a:s>return </a:s>
                                          <a:s r="1072">
                                             <a:s r="1071">
                                                <a:s>R</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1072">
                                                <a:s>reference</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
    )</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                     <a:s r="1083"> then
    true
  else
    false</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1023" locator="288:3-298:9" xsi:type="If">
            <condition localId="1024" locator="288:6-295:3" xsi:type="Or">
               <operand localId="1025" locator="289:5-290:31" xsi:type="Or">
                  <operand localId="1028" locator="289:5-289:38" name="AssociateDiagnosticReports" xsi:type="FunctionRef">
                     <operand localId="1026" locator="289:32-289:33" name="d1" xsi:type="OperandRef"/>
                     <operand localId="1027" locator="289:36-289:37" name="d2" xsi:type="OperandRef"/>
                  </operand>
                  <operand localId="1029" locator="290:5-290:31" xsi:type="Equal">
                     <signature localId="1034" name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1035" name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1031" locator="290:5-290:16" path="encounter" xsi:type="Property">
                        <source localId="1030" locator="290:5-290:6" name="d1" xsi:type="OperandRef"/>
                     </operand>
                     <operand localId="1033" locator="290:20-290:31" path="encounter" xsi:type="Property">
                        <source localId="1032" locator="290:20-290:21" name="d2" xsi:type="OperandRef"/>
                     </operand>
                  </operand>
               </operand>
               <operand localId="1036" locator="291:5-294:5" xsi:type="Equal">
                  <signature localId="1081" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1082" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1056" locator="292:7-292:81" xsi:type="Coalesce">
                     <signature localId="1057" xsi:type="ListTypeSpecifier">
                        <elementType localId="1058" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="1051" locator="292:16-292:80" xsi:type="Query">
                        <source localId="1037" locator="292:16-292:29" alias="R">
                           <expression localId="1039" locator="292:16-292:27" path="basedOn" xsi:type="Property">
                              <source localId="1038" locator="292:17-292:18" name="d1" xsi:type="OperandRef"/>
                           </expression>
                        </source>
                        <where localId="1040" locator="292:31-292:61" xsi:type="Equal">
                           <signature localId="1046" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1047" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1044" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature localId="1045" name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="1042" locator="292:37-292:42" path="type" scope="R" xsi:type="Property"/>
                           </operand>
                           <operand localId="1043" locator="292:46-292:61" valueType="t:String" value="ServiceRequest" xsi:type="Literal"/>
                        </where>
                        <return localId="1048" locator="292:63-292:80">
                           <expression localId="1050" locator="292:70-292:80" path="reference" scope="R" xsi:type="Property"/>
                        </return>
                     </operand>
                  </operand>
                  <operand localId="1078" locator="293:7-293:81" xsi:type="Coalesce">
                     <signature localId="1079" xsi:type="ListTypeSpecifier">
                        <elementType localId="1080" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="1073" locator="293:16-293:80" xsi:type="Query">
                        <source localId="1059" locator="293:16-293:29" alias="R">
                           <expression localId="1061" locator="293:16-293:27" path="basedOn" xsi:type="Property">
                              <source localId="1060" locator="293:17-293:18" name="d2" xsi:type="OperandRef"/>
                           </expression>
                        </source>
                        <where localId="1062" locator="293:31-293:61" xsi:type="Equal">
                           <signature localId="1068" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1069" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1066" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature localId="1067" name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="1064" locator="293:37-293:42" path="type" scope="R" xsi:type="Property"/>
                           </operand>
                           <operand localId="1065" locator="293:46-293:61" valueType="t:String" value="ServiceRequest" xsi:type="Literal"/>
                        </where>
                        <return localId="1070" locator="293:63-293:80">
                           <expression localId="1072" locator="293:70-293:80" path="reference" scope="R" xsi:type="Property"/>
                        </return>
                     </operand>
                  </operand>
               </operand>
            </condition>
            <then localId="1083" locator="296:5-296:8" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            <else localId="1084" locator="298:5-298:9" valueType="t:Boolean" value="false" xsi:type="Literal"/>
         </expression>
         <operand localId="1020" name="d1">
            <operandTypeSpecifier localId="1019" locator="287:48-287:68" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand localId="1022" name="d2">
            <operandTypeSpecifier localId="1021" locator="287:74-287:94" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1085" locator="311:1-315:36" name="RelevantEncounterStatus" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1085">
               <a:s>/*******************************************************************************
* Encounter Functions
*******************************************************************************/

/**
 * Encounters that are triaged, in-progress or completed.
 * @see http://hl7.org/fhir/R4/valueset-encounter-status.html
 * @param EncList - a list of Encounters
 * @returns {List&lt;Encounter>} a list of encounters, or null if null was passed in
 */
define function RelevantEncounterStatus(EncList List&lt;Encounter>):
  </a:s>
               <a:s r="1114">
                  <a:s r="1114">
                     <a:s>
                        <a:s r="1089">
                           <a:s r="1090">
                              <a:s>
                                 <a:s>EncList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> E</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1091">
                        <a:s>where </a:s>
                        <a:s r="1091">
                           <a:s r="1092">
                              <a:s r="1093">
                                 <a:s r="1096">
                                    <a:s r="1095">
                                       <a:s r="1094">
                                          <a:s>E</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1095">
                                          <a:s>status</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1096">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="1097">
                                    <a:s>'triaged'</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      or </a:s>
                              <a:s r="1100">
                                 <a:s r="1103">
                                    <a:s r="1102">
                                       <a:s r="1101">
                                          <a:s>E</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1102">
                                          <a:s>status</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1103">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="1104">
                                    <a:s>'in-progress'</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="1107">
                              <a:s r="1110">
                                 <a:s r="1109">
                                    <a:s r="1108">
                                       <a:s>E</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1109">
                                       <a:s>status</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1110">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> = </a:s>
                              <a:s r="1111">
                                 <a:s>'finished'</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1114" locator="312:3-315:36" xsi:type="Query">
            <source localId="1089" locator="312:3-312:11" alias="E">
               <expression localId="1090" locator="312:3-312:9" name="EncList" xsi:type="OperandRef"/>
            </source>
            <where localId="1091" locator="313:5-315:36" xsi:type="Or">
               <operand localId="1092" locator="313:11-314:39" xsi:type="Or">
                  <operand localId="1093" locator="313:11-313:36" xsi:type="Equal">
                     <signature localId="1098" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1099" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1096" locator="313:11-313:24" path="value" xsi:type="Property">
                        <source localId="1095" locator="313:11-313:18" path="status" scope="E" xsi:type="Property"/>
                     </operand>
                     <operand localId="1097" locator="313:28-313:36" valueType="t:String" value="triaged" xsi:type="Literal"/>
                  </operand>
                  <operand localId="1100" locator="314:10-314:39" xsi:type="Equal">
                     <signature localId="1105" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1106" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1103" locator="314:10-314:23" path="value" xsi:type="Property">
                        <source localId="1102" locator="314:10-314:17" path="status" scope="E" xsi:type="Property"/>
                     </operand>
                     <operand localId="1104" locator="314:27-314:39" valueType="t:String" value="in-progress" xsi:type="Literal"/>
                  </operand>
               </operand>
               <operand localId="1107" locator="315:10-315:36" xsi:type="Equal">
                  <signature localId="1112" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1113" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1110" locator="315:10-315:23" path="value" xsi:type="Property">
                     <source localId="1109" locator="315:10-315:17" path="status" scope="E" xsi:type="Property"/>
                  </operand>
                  <operand localId="1111" locator="315:27-315:36" valueType="t:String" value="finished" xsi:type="Literal"/>
               </operand>
            </where>
         </expression>
         <operand localId="1088" name="EncList">
            <operandTypeSpecifier localId="1086" locator="311:49-311:63" xsi:type="ListTypeSpecifier">
               <elementType localId="1087" locator="311:54-311:62" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1115" locator="326:1-331:3" name="MedicationAdministrationDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1115">
               <a:s>/*******************************************************************************
* Medication Functions
*******************************************************************************/

// Returns a text representation of a date associated with a MedicationAdministration, preferring `effectiveDateTime`, then
// `.start`.
// @param s - a FHIR MedicationAdministration to get the text date from
// @returns {System.String} the text representation of a relevant date from the MedicationAdministration
define function MedicationAdministrationDate(a FHIR.MedicationAdministration):
  </a:s>
               <a:s r="1140">
                  <a:s r="1140">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="1122">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1118">
                           <a:s r="1120">
                              <a:s r="1119">
                                 <a:s>a</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1120">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="1121">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1128">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1127">
                           <a:s r="1123">
                              <a:s>(</a:s>
                              <a:s r="1123">
                                 <a:s r="1125">
                                    <a:s r="1124">
                                       <a:s>a</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1125">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1126">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1127">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1134">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1133">
                           <a:s r="1129">
                              <a:s>(</a:s>
                              <a:s r="1129">
                                 <a:s r="1131">
                                    <a:s r="1130">
                                       <a:s>a</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1131">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1132">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1133">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1140" locator="327:3-331:3" xsi:type="Coalesce">
            <signature localId="1141" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1142" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1143" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <operand localId="1122" locator="328:5-328:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1118" locator="328:18-328:45" strict="false" xsi:type="As">
                  <operand localId="1120" locator="328:18-328:28" path="effective" xsi:type="Property">
                     <source localId="1119" locator="328:18" name="a" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="1121" locator="328:33-328:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="1128" locator="329:5-329:52" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1127" locator="329:18-329:51" path="end" xsi:type="Property">
                  <source localId="1123" locator="329:18-329:45" strict="false" xsi:type="As">
                     <operand localId="1125" locator="329:19-329:29" path="effective" xsi:type="Property">
                        <source localId="1124" locator="329:19" name="a" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1126" locator="329:34-329:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="1134" locator="330:5-330:54" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1133" locator="330:18-330:53" path="start" xsi:type="Property">
                  <source localId="1129" locator="330:18-330:45" strict="false" xsi:type="As">
                     <operand localId="1131" locator="330:19-330:29" path="effective" xsi:type="Property">
                        <source localId="1130" locator="330:19" name="a" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1132" locator="330:34-330:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
         </expression>
         <operand localId="1117" name="a">
            <operandTypeSpecifier localId="1116" locator="326:48-326:76" name="fhir:MedicationAdministration" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1144" locator="339:1-341:38" name="CompletedMedicationAdministration" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1144">
               <a:s>/**
* Medication administrations that are completed, according to a prescription.
* @see https://www.hl7.org/fhir/valueset-medication-admin-status.html
* @param MedList - a list of MedicationAdministrations
* @returns {List&lt;MedicationAdministration>} a list of completed medication administrations, or null if null was passed in
*/
define function CompletedMedicationAdministration(MedList List&lt;MedicationAdministration>):
  </a:s>
               <a:s r="1157">
                  <a:s r="1157">
                     <a:s>
                        <a:s r="1148">
                           <a:s r="1149">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1150">
                        <a:s>where </a:s>
                        <a:s r="1150">
                           <a:s r="1153">
                              <a:s r="1152">
                                 <a:s r="1151">
                                    <a:s>M</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1152">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1153">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1154">
                              <a:s>'completed'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1157" locator="340:3-341:38" xsi:type="Query">
            <source localId="1148" locator="340:3-340:11" alias="M">
               <expression localId="1149" locator="340:3-340:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <where localId="1150" locator="341:5-341:38" xsi:type="Equal">
               <signature localId="1155" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1156" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="1153" locator="341:11-341:24" path="value" xsi:type="Property">
                  <source localId="1152" locator="341:11-341:18" path="status" scope="M" xsi:type="Property"/>
               </operand>
               <operand localId="1154" locator="341:28-341:38" valueType="t:String" value="completed" xsi:type="Literal"/>
            </where>
         </expression>
         <operand localId="1147" name="MedList">
            <operandTypeSpecifier localId="1145" locator="339:59-339:88" xsi:type="ListTypeSpecifier">
               <elementType localId="1146" locator="339:64-339:87" name="fhir:MedicationAdministration" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1158" locator="343:1-345:38" name="CompletedMedicationDispense" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1158">
               <a:s>define function CompletedMedicationDispense(MedList List&lt;MedicationDispense>):
  </a:s>
               <a:s r="1171">
                  <a:s r="1171">
                     <a:s>
                        <a:s r="1162">
                           <a:s r="1163">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1164">
                        <a:s>where </a:s>
                        <a:s r="1164">
                           <a:s r="1167">
                              <a:s r="1166">
                                 <a:s r="1165">
                                    <a:s>M</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1166">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1167">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1168">
                              <a:s>'completed'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1171" locator="344:3-345:38" xsi:type="Query">
            <source localId="1162" locator="344:3-344:11" alias="M">
               <expression localId="1163" locator="344:3-344:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <where localId="1164" locator="345:5-345:38" xsi:type="Equal">
               <signature localId="1169" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1170" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="1167" locator="345:11-345:24" path="value" xsi:type="Property">
                  <source localId="1166" locator="345:11-345:18" path="status" scope="M" xsi:type="Property"/>
               </operand>
               <operand localId="1168" locator="345:28-345:38" valueType="t:String" value="completed" xsi:type="Literal"/>
            </where>
         </expression>
         <operand localId="1161" name="MedList">
            <operandTypeSpecifier localId="1159" locator="343:53-343:76" xsi:type="ListTypeSpecifier">
               <elementType localId="1160" locator="343:58-343:75" name="fhir:MedicationDispense" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1172" locator="353:1-355:77" name="CompletedDiagnosticReport" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1172">
               <a:s>/**
* Diagnostic reports that are completed.
* @see https://www.hl7.org/fhir/valueset-diagnostic-report-status.html
* @param DiagnosticReportList - a list of DiagnosticReports
* @returns {List&lt;DiagnosticReport>} a list of completed diagnostic reports, or null if null was passed in
*/
define function CompletedDiagnosticReport(DiagnosticReportList List&lt;DiagnosticReport>):
  </a:s>
               <a:s r="1190">
                  <a:s r="1190">
                     <a:s>
                        <a:s r="1176">
                           <a:s r="1177">
                              <a:s>
                                 <a:s>DiagnosticReportList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> D</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1186">
                        <a:s>where </a:s>
                        <a:s r="1186">
                           <a:s r="1180">
                              <a:s r="1179">
                                 <a:s r="1178">
                                    <a:s>D</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1179">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1180">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> in </a:s>
                           <a:s r="1181">
                              <a:s>List{</a:s>
                              <a:s r="1182">
                                 <a:s>'final'</a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="1183">
                                 <a:s>'amended'</a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="1184">
                                 <a:s>'corrected'</a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="1185">
                                 <a:s>'appended'</a:s>
                              </a:s>
                              <a:s>}</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1190" locator="354:3-355:77" xsi:type="Query">
            <source localId="1176" locator="354:3-354:24" alias="D">
               <expression localId="1177" locator="354:3-354:22" name="DiagnosticReportList" xsi:type="OperandRef"/>
            </source>
            <where localId="1186" locator="355:5-355:77" xsi:type="In">
               <signature localId="1187" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1188" xsi:type="ListTypeSpecifier">
                  <elementType localId="1189" name="t:String" xsi:type="NamedTypeSpecifier"/>
               </signature>
               <operand localId="1180" locator="355:11-355:24" path="value" xsi:type="Property">
                  <source localId="1179" locator="355:11-355:18" path="status" scope="D" xsi:type="Property"/>
               </operand>
               <operand localId="1181" locator="355:29-355:77" xsi:type="List">
                  <element localId="1182" locator="355:34-355:40" valueType="t:String" value="final" xsi:type="Literal"/>
                  <element localId="1183" locator="355:43-355:51" valueType="t:String" value="amended" xsi:type="Literal"/>
                  <element localId="1184" locator="355:54-355:64" valueType="t:String" value="corrected" xsi:type="Literal"/>
                  <element localId="1185" locator="355:67-355:76" valueType="t:String" value="appended" xsi:type="Literal"/>
               </operand>
            </where>
         </expression>
         <operand localId="1175" name="DiagnosticReportList">
            <operandTypeSpecifier localId="1173" locator="353:64-353:85" xsi:type="ListTypeSpecifier">
               <elementType localId="1174" locator="353:69-353:84" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1191" locator="365:1-369:83" name="LookBack" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1191">
               <a:s>/**
* Medication Administrations that are issued in the specified &quot;look back&quot; period.
* TODO: Rename to LookBack once the execution engine supports overloaded functions.
* @param MedList - a list of MedicationAdministrations
* @param LookBack - the lookback period for when the medication was prescribed
* @returns {List&lt;MedicationAdministration>} a list of MedicationAdministrations prescribed in the look back period, or null if null
* was passed in
*/
define function LookBack(MedList List&lt;MedicationAdministration>, LookBack System.Quantity):
  </a:s>
               <a:s r="1230">
                  <a:s r="1230">
                     <a:s>
                        <a:s r="1197">
                           <a:s r="1198">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="1199">
                           <a:s>LookBackInterval: </a:s>
                           <a:s r="1210">
                              <a:s>Interval[</a:s>
                              <a:s r="1200">
                                 <a:s r="1203">
                                    <a:s>Now()</a:s>
                                 </a:s>
                                 <a:s> - </a:s>
                                 <a:s r="1204">
                                    <a:s>LookBack</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="1209">
                                 <a:s>Now()</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1211">
                        <a:s>where </a:s>
                        <a:s r="1211">
                           <a:s r="1218">
                              <a:s r="1216">
                                 <a:s r="1212">
                                    <a:s>(</a:s>
                                    <a:s r="1212">
                                       <a:s r="1214">
                                          <a:s r="1213">
                                             <a:s>M</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1214">
                                             <a:s>effective</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="1215">
                                          <a:s>FHIR.dateTime</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1216">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> in </a:s>
                              <a:s r="1217">
                                 <a:s>LookBackInterval</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="1229">
                              <a:s r="1227">
                                 <a:s r="1222">
                                    <a:s>C3F</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1227">
                                    <a:s>PeriodToInterval(</a:s>
                                    <a:s r="1223">
                                       <a:s r="1225">
                                          <a:s r="1224">
                                             <a:s>M</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1225">
                                             <a:s>effective</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="1226">
                                          <a:s>FHIR.Period</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="1229"> overlaps </a:s>
                              <a:s r="1228">
                                 <a:s>LookBackInterval</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1230" locator="366:3-369:83" xsi:type="Query">
            <source localId="1197" locator="366:3-366:11" alias="M">
               <expression localId="1198" locator="366:3-366:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <let localId="1199" locator="367:9-367:59" identifier="LookBackInterval">
               <expression localId="1210" locator="367:27-367:59" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <low localId="1200" locator="367:36-367:51" xsi:type="Subtract">
                     <signature localId="1205" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1206" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1203" locator="367:36-367:40" xsi:type="Now"/>
                     <operand localId="1204" locator="367:44-367:51" name="LookBack" xsi:type="OperandRef"/>
                  </low>
                  <high localId="1209" locator="367:54-367:58" xsi:type="Now"/>
               </expression>
            </let>
            <where localId="1211" locator="368:5-369:83" xsi:type="Or">
               <operand localId="1218" locator="368:11-368:66" xsi:type="In">
                  <signature localId="1219" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1220" xsi:type="IntervalTypeSpecifier">
                     <pointType localId="1221" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="1216" locator="368:11-368:46" path="value" xsi:type="Property">
                     <source localId="1212" locator="368:11-368:40" strict="false" xsi:type="As">
                        <operand localId="1214" locator="368:12-368:22" path="effective" scope="M" xsi:type="Property"/>
                        <asTypeSpecifier localId="1215" locator="368:27-368:39" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </source>
                  </operand>
                  <operand localId="1217" locator="368:51-368:66" name="LookBackInterval" xsi:type="QueryLetRef"/>
               </operand>
               <operand localId="1229" locator="369:10-369:83" xsi:type="Overlaps">
                  <operand localId="1227" locator="369:10-369:57" name="PeriodToInterval" libraryName="C3F" xsi:type="FunctionRef">
                     <operand localId="1223" locator="369:31-369:56" strict="false" xsi:type="As">
                        <operand localId="1225" locator="369:31-369:41" path="effective" scope="M" xsi:type="Property"/>
                        <asTypeSpecifier localId="1226" locator="369:46-369:56" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </operand>
                  <operand localId="1228" locator="369:68-369:83" name="LookBackInterval" xsi:type="QueryLetRef"/>
               </operand>
            </where>
         </expression>
         <operand localId="1194" name="MedList">
            <operandTypeSpecifier localId="1192" locator="365:34-365:63" xsi:type="ListTypeSpecifier">
               <elementType localId="1193" locator="365:39-365:62" name="fhir:MedicationAdministration" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
         <operand localId="1196" name="LookBack">
            <operandTypeSpecifier localId="1195" locator="365:75-365:89" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1231" locator="377:1-379:38" name="CompletedMedicationRequest" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1231">
               <a:s>/**
* Medication requests that are completed, according to a prescription.
* @see http://hl7.org/fhir/R4/valueset-medicationrequest-status.html
* @param MedList - a list of MedicationRequests
* @returns {List&lt;MedicationRequest>} a list of completed medication requests, or null if null was passed in
*/
define function CompletedMedicationRequest(MedList List&lt;MedicationRequest>):
  </a:s>
               <a:s r="1244">
                  <a:s r="1244">
                     <a:s>
                        <a:s r="1235">
                           <a:s r="1236">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1237">
                        <a:s>where </a:s>
                        <a:s r="1237">
                           <a:s r="1240">
                              <a:s r="1239">
                                 <a:s r="1238">
                                    <a:s>M</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1239">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1240">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1241">
                              <a:s>'completed'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1244" locator="378:3-379:38" xsi:type="Query">
            <source localId="1235" locator="378:3-378:11" alias="M">
               <expression localId="1236" locator="378:3-378:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <where localId="1237" locator="379:5-379:38" xsi:type="Equal">
               <signature localId="1242" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1243" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="1240" locator="379:11-379:24" path="value" xsi:type="Property">
                  <source localId="1239" locator="379:11-379:18" path="status" scope="M" xsi:type="Property"/>
               </operand>
               <operand localId="1241" locator="379:28-379:38" valueType="t:String" value="completed" xsi:type="Literal"/>
            </where>
         </expression>
         <operand localId="1234" name="MedList">
            <operandTypeSpecifier localId="1232" locator="377:52-377:74" xsi:type="ListTypeSpecifier">
               <elementType localId="1233" locator="377:57-377:73" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1245" locator="387:1-393:42" name="MedicationRequestsWithOrderIntent" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1245">
               <a:s>/**
* Medication requests with an intent of 'order', or one of the sub-categories of 'order'.
* @see http://hl7.org/fhir/R4/valueset-medicationrequest-intent.html
* @param MedList - a list of MedicationRequests
* @returns {List&lt;MedicationRequest>} a list of medication requests with an intent of 'order', or null if null was passed in
*/
define function MedicationRequestsWithOrderIntent(MedList List&lt;MedicationRequest>):
  </a:s>
               <a:s r="1290">
                  <a:s r="1290">
                     <a:s>
                        <a:s r="1249">
                           <a:s r="1250">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1251">
                        <a:s>where </a:s>
                        <a:s r="1251">
                           <a:s r="1252">
                              <a:s r="1253">
                                 <a:s r="1254">
                                    <a:s r="1255">
                                       <a:s r="1258">
                                          <a:s r="1257">
                                             <a:s r="1256">
                                                <a:s>M</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1257">
                                                <a:s>intent</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1258">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> = </a:s>
                                       <a:s r="1259">
                                          <a:s>'order'</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
      or </a:s>
                                    <a:s r="1262">
                                       <a:s r="1265">
                                          <a:s r="1264">
                                             <a:s r="1263">
                                                <a:s>M</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1264">
                                                <a:s>intent</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1265">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> = </a:s>
                                       <a:s r="1266">
                                          <a:s>'original-order'</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
      or </a:s>
                                 <a:s r="1269">
                                    <a:s r="1272">
                                       <a:s r="1271">
                                          <a:s r="1270">
                                             <a:s>M</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1271">
                                             <a:s>intent</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1272">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> = </a:s>
                                    <a:s r="1273">
                                       <a:s>'reflex-order'</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      or </a:s>
                              <a:s r="1276">
                                 <a:s r="1279">
                                    <a:s r="1278">
                                       <a:s r="1277">
                                          <a:s>M</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1278">
                                          <a:s>intent</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1279">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="1280">
                                    <a:s>'filler-order'</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="1283">
                              <a:s r="1286">
                                 <a:s r="1285">
                                    <a:s r="1284">
                                       <a:s>M</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1285">
                                       <a:s>intent</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1286">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> = </a:s>
                              <a:s r="1287">
                                 <a:s>'instance-order'</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1290" locator="388:3-393:42" xsi:type="Query">
            <source localId="1249" locator="388:3-388:11" alias="M">
               <expression localId="1250" locator="388:3-388:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <where localId="1251" locator="389:5-393:42" xsi:type="Or">
               <operand localId="1252" locator="389:11-392:40" xsi:type="Or">
                  <operand localId="1253" locator="389:11-391:40" xsi:type="Or">
                     <operand localId="1254" locator="389:11-390:42" xsi:type="Or">
                        <operand localId="1255" locator="389:11-389:34" xsi:type="Equal">
                           <signature localId="1260" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1261" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1258" locator="389:11-389:24" path="value" xsi:type="Property">
                              <source localId="1257" locator="389:11-389:18" path="intent" scope="M" xsi:type="Property"/>
                           </operand>
                           <operand localId="1259" locator="389:28-389:34" valueType="t:String" value="order" xsi:type="Literal"/>
                        </operand>
                        <operand localId="1262" locator="390:10-390:42" xsi:type="Equal">
                           <signature localId="1267" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1268" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1265" locator="390:10-390:23" path="value" xsi:type="Property">
                              <source localId="1264" locator="390:10-390:17" path="intent" scope="M" xsi:type="Property"/>
                           </operand>
                           <operand localId="1266" locator="390:27-390:42" valueType="t:String" value="original-order" xsi:type="Literal"/>
                        </operand>
                     </operand>
                     <operand localId="1269" locator="391:10-391:40" xsi:type="Equal">
                        <signature localId="1274" name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1275" name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1272" locator="391:10-391:23" path="value" xsi:type="Property">
                           <source localId="1271" locator="391:10-391:17" path="intent" scope="M" xsi:type="Property"/>
                        </operand>
                        <operand localId="1273" locator="391:27-391:40" valueType="t:String" value="reflex-order" xsi:type="Literal"/>
                     </operand>
                  </operand>
                  <operand localId="1276" locator="392:10-392:40" xsi:type="Equal">
                     <signature localId="1281" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1282" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1279" locator="392:10-392:23" path="value" xsi:type="Property">
                        <source localId="1278" locator="392:10-392:17" path="intent" scope="M" xsi:type="Property"/>
                     </operand>
                     <operand localId="1280" locator="392:27-392:40" valueType="t:String" value="filler-order" xsi:type="Literal"/>
                  </operand>
               </operand>
               <operand localId="1283" locator="393:10-393:42" xsi:type="Equal">
                  <signature localId="1288" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1289" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1286" locator="393:10-393:23" path="value" xsi:type="Property">
                     <source localId="1285" locator="393:10-393:17" path="intent" scope="M" xsi:type="Property"/>
                  </operand>
                  <operand localId="1287" locator="393:27-393:42" valueType="t:String" value="instance-order" xsi:type="Literal"/>
               </operand>
            </where>
         </expression>
         <operand localId="1248" name="MedList">
            <operandTypeSpecifier localId="1246" locator="387:59-387:81" xsi:type="ListTypeSpecifier">
               <elementType localId="1247" locator="387:64-387:80" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1291" locator="404:1-409:3" name="ProcedureDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1291">
               <a:s>/*******************************************************************************
* Observation Functions
*******************************************************************************/


/*******************************************************************************
* Procedure Functions
*******************************************************************************/

define function ProcedureDate(p FHIR.Procedure):
  </a:s>
               <a:s r="1316">
                  <a:s r="1316">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="1298">
                        <a:s r="1294">
                           <a:s>(</a:s>
                           <a:s r="1294">
                              <a:s r="1296">
                                 <a:s r="1295">
                                    <a:s>p</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1296">
                                    <a:s>performed</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="1297">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="1298">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1304">
                        <a:s r="1303">
                           <a:s r="1299">
                              <a:s>(</a:s>
                              <a:s r="1299">
                                 <a:s r="1301">
                                    <a:s r="1300">
                                       <a:s>p</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1301">
                                       <a:s>performed</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1302">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1303">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="1304">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1310">
                        <a:s r="1309">
                           <a:s r="1305">
                              <a:s>(</a:s>
                              <a:s r="1305">
                                 <a:s r="1307">
                                    <a:s r="1306">
                                       <a:s>p</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1307">
                                       <a:s>performed</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1308">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1309">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="1310">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1316" locator="405:3-409:3" xsi:type="Coalesce">
            <signature localId="1317" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1318" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1319" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <operand localId="1298" locator="406:5-406:40" path="value" xsi:type="Property">
               <source localId="1294" locator="406:5-406:34" strict="false" xsi:type="As">
                  <operand localId="1296" locator="406:6-406:16" path="performed" xsi:type="Property">
                     <source localId="1295" locator="406:6" name="p" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="1297" locator="406:21-406:33" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="1304" locator="407:5-407:44" path="value" xsi:type="Property">
               <source localId="1303" locator="407:5-407:38" path="end" xsi:type="Property">
                  <source localId="1299" locator="407:5-407:32" strict="false" xsi:type="As">
                     <operand localId="1301" locator="407:6-407:16" path="performed" xsi:type="Property">
                        <source localId="1300" locator="407:6" name="p" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1302" locator="407:21-407:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="1310" locator="408:5-408:46" path="value" xsi:type="Property">
               <source localId="1309" locator="408:5-408:40" path="start" xsi:type="Property">
                  <source localId="1305" locator="408:5-408:32" strict="false" xsi:type="As">
                     <operand localId="1307" locator="408:6-408:16" path="performed" xsi:type="Property">
                        <source localId="1306" locator="408:6" name="p" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1308" locator="408:21-408:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
         </expression>
         <operand localId="1293" name="p">
            <operandTypeSpecifier localId="1292" locator="404:33-404:46" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1320" locator="416:1-421:3" name="ProcedureDateString" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1320">
               <a:s>// TODO: Can replace this with an overloaded function
// Returns a text representation of a date associated with a Procedure, preferring `effectiveDateTime`, then
// `.start`.
// @param s - a FHIR Procedure to get the text date from
// @returns {System.String} the text representation of a relevant date from the Procedure
define function ProcedureDateString(p FHIR.Procedure):
  </a:s>
               <a:s r="1345">
                  <a:s r="1345">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="1327">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1323">
                           <a:s r="1325">
                              <a:s r="1324">
                                 <a:s>p</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1325">
                                 <a:s>performed</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="1326">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1333">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1332">
                           <a:s r="1328">
                              <a:s>(</a:s>
                              <a:s r="1328">
                                 <a:s r="1330">
                                    <a:s r="1329">
                                       <a:s>p</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1330">
                                       <a:s>performed</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1331">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1332">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1339">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1338">
                           <a:s r="1334">
                              <a:s>(</a:s>
                              <a:s r="1334">
                                 <a:s r="1336">
                                    <a:s r="1335">
                                       <a:s>p</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1336">
                                       <a:s>performed</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1337">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1338">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1345" locator="417:3-421:3" xsi:type="Coalesce">
            <signature localId="1346" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1347" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1348" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <operand localId="1327" locator="418:5-418:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1323" locator="418:18-418:45" strict="false" xsi:type="As">
                  <operand localId="1325" locator="418:18-418:28" path="performed" xsi:type="Property">
                     <source localId="1324" locator="418:18" name="p" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="1326" locator="418:33-418:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="1333" locator="419:5-419:52" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1332" locator="419:18-419:51" path="end" xsi:type="Property">
                  <source localId="1328" locator="419:18-419:45" strict="false" xsi:type="As">
                     <operand localId="1330" locator="419:19-419:29" path="performed" xsi:type="Property">
                        <source localId="1329" locator="419:19" name="p" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1331" locator="419:34-419:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="1339" locator="420:5-420:54" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1338" locator="420:18-420:53" path="start" xsi:type="Property">
                  <source localId="1334" locator="420:18-420:45" strict="false" xsi:type="As">
                     <operand localId="1336" locator="420:19-420:29" path="performed" xsi:type="Property">
                        <source localId="1335" locator="420:19" name="p" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1337" locator="420:34-420:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
         </expression>
         <operand localId="1322" name="p">
            <operandTypeSpecifier localId="1321" locator="416:39-416:52" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1349" locator="430:1-435:3" name="OldestProcedure" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1349">
               <a:s>/**
 * The oldest procedure.  For each Procedure, this algorithm will use the Coalesce function, which returns the
 * first non-null result from these fields: performedDateTime, performedPeriod.start, performedPeriod.end.
 * The found date will be used to compare Procedures and determine the oldest one.
 * @param ProcList - a list of Procedures
 * @returns {Procedure} the oldest Procedure from the list, or null if null was passed in
 */
define function OldestProcedure(ProcList List&lt;Procedure>):
  </a:s>
               <a:s r="1407">
                  <a:s r="1407">
                     <a:s>First(</a:s>
                     <a:s r="1402">
                        <a:s>
                           <a:s r="1353">
                              <a:s r="1354">
                                 <a:s>
                                    <a:s>ProcList</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> P</a:s>
                           </a:s>
                        </a:s>
                        <a:s> </a:s>
                        <a:s r="1396">
                           <a:s>sort by </a:s>
                           <a:s r="1395">
                              <a:s r="1391">
                                 <a:s>Coalesce(
    </a:s>
                                 <a:s r="1375">
                                    <a:s r="1372">
                                       <a:s>(</a:s>
                                       <a:s r="1372">
                                          <a:s r="1373">
                                             <a:s>performed</a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="1374">
                                             <a:s>FHIR.dateTime</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1375">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="1380">
                                    <a:s r="1379">
                                       <a:s r="1376">
                                          <a:s>(</a:s>
                                          <a:s r="1376">
                                             <a:s r="1377">
                                                <a:s>performed</a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="1378">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1379">
                                          <a:s>&quot;start&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1380">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="1385">
                                    <a:s r="1384">
                                       <a:s r="1381">
                                          <a:s>(</a:s>
                                          <a:s r="1381">
                                             <a:s r="1382">
                                                <a:s>performed</a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="1383">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1384">
                                          <a:s>&quot;end&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1385">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1407" locator="431:3-435:3" xsi:type="First">
            <signature localId="1408" xsi:type="ListTypeSpecifier">
               <elementType localId="1409" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <source localId="1402" locator="431:9-434:43" xsi:type="Query">
               <source localId="1353" locator="431:9-431:18" alias="P">
                  <expression localId="1354" locator="431:9-431:16" name="ProcList" xsi:type="OperandRef"/>
               </source>
               <sort localId="1396" locator="431:20-434:43">
                  <by localId="1395" locator="431:28-434:43" direction="asc" xsi:type="ByExpression">
                     <expression localId="1391" locator="431:28-434:43" xsi:type="Coalesce">
                        <signature localId="1392" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1393" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1394" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1375" locator="432:5-432:38" path="value" xsi:type="Property">
                           <source localId="1372" locator="432:5-432:32" strict="false" xsi:type="As">
                              <operand localId="1373" locator="432:6-432:14" name="performed" xsi:type="IdentifierRef"/>
                              <asTypeSpecifier localId="1374" locator="432:19-432:31" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </operand>
                        <operand localId="1380" locator="433:5-433:44" path="value" xsi:type="Property">
                           <source localId="1379" locator="433:5-433:38" path="start" xsi:type="Property">
                              <source localId="1376" locator="433:5-433:30" strict="false" xsi:type="As">
                                 <operand localId="1377" locator="433:6-433:14" name="performed" xsi:type="IdentifierRef"/>
                                 <asTypeSpecifier localId="1378" locator="433:19-433:29" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </source>
                        </operand>
                        <operand localId="1385" locator="434:5-434:42" path="value" xsi:type="Property">
                           <source localId="1384" locator="434:5-434:36" path="end" xsi:type="Property">
                              <source localId="1381" locator="434:5-434:30" strict="false" xsi:type="As">
                                 <operand localId="1382" locator="434:6-434:14" name="performed" xsi:type="IdentifierRef"/>
                                 <asTypeSpecifier localId="1383" locator="434:19-434:29" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </source>
                        </operand>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
         <operand localId="1352" name="ProcList">
            <operandTypeSpecifier localId="1350" locator="430:42-430:56" xsi:type="ListTypeSpecifier">
               <elementType localId="1351" locator="430:47-430:55" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1410" locator="445:1-450:3" name="DateOfFirstProcedure" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1410">
               <a:s>/**
 * Date of the oldest procedure in a list.  For each Procedure, this algorithm will use the Coalesce function, which returns the
 * first non-null result from these fields: performedDateTime, performedPeriod.end, performedPeriod.start.
 * The found date will be used to compare Procedures and determine the oldest one. The date of the oldest Procedure
 * will be returned.
 * @param ProcList - a list of Procedures
 * @returns {System.String} the text representation of the Procedure's date
 */
define function DateOfFirstProcedure(ProcList List&lt;Procedure>):
  </a:s>
               <a:s r="1416">
                  <a:s r="1416">
                     <a:s>ProcedureDate(
    </a:s>
                     <a:s r="1415">
                        <a:s>OldestProcedure(
      </a:s>
                        <a:s r="1414">
                           <a:s>ProcList</a:s>
                        </a:s>
                        <a:s>
    )</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1416" locator="446:3-450:3" name="ProcedureDate" xsi:type="FunctionRef">
            <operand localId="1415" locator="447:5-449:5" name="OldestProcedure" xsi:type="FunctionRef">
               <operand localId="1414" locator="448:7-448:14" name="ProcList" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand localId="1413" name="ProcList">
            <operandTypeSpecifier localId="1411" locator="445:47-445:61" xsi:type="ListTypeSpecifier">
               <elementType localId="1412" locator="445:52-445:60" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1417" locator="462:1-464:38" name="CompletedImmunization" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1417">
               <a:s>/*******************************************************************************
* Immunization Functions
*******************************************************************************/

/**
* Immunizations that are completed.
* @see http://hl7.org/fhir/R4/valueset-immunization-status.html
* @param ImmunizationList - a list of Immunizations
* @returns {List&lt;Immunization>} a list of completed immunizations, or null if null was passed in
*/
define function CompletedImmunization(ImmunizationList List&lt;Immunization>):
  </a:s>
               <a:s r="1430">
                  <a:s r="1430">
                     <a:s>
                        <a:s r="1421">
                           <a:s r="1422">
                              <a:s>
                                 <a:s>ImmunizationList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> I</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1423">
                        <a:s>where </a:s>
                        <a:s r="1423">
                           <a:s r="1426">
                              <a:s r="1425">
                                 <a:s r="1424">
                                    <a:s>I</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1425">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1426">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1427">
                              <a:s>'completed'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1430" locator="463:3-464:38" xsi:type="Query">
            <source localId="1421" locator="463:3-463:20" alias="I">
               <expression localId="1422" locator="463:3-463:18" name="ImmunizationList" xsi:type="OperandRef"/>
            </source>
            <where localId="1423" locator="464:5-464:38" xsi:type="Equal">
               <signature localId="1428" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1429" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="1426" locator="464:11-464:24" path="value" xsi:type="Property">
                  <source localId="1425" locator="464:11-464:18" path="status" scope="I" xsi:type="Property"/>
               </operand>
               <operand localId="1427" locator="464:28-464:38" valueType="t:String" value="completed" xsi:type="Literal"/>
            </where>
         </expression>
         <operand localId="1420" name="ImmunizationList">
            <operandTypeSpecifier localId="1418" locator="462:56-462:73" xsi:type="ListTypeSpecifier">
               <elementType localId="1419" locator="462:61-462:72" name="fhir:Immunization" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
   </statements>
</library>
