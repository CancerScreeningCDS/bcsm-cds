<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>Average Risk - Breast Cancer Screening and Management (BCSM) Clinical Decision Support (CDS) Implementation Guide v1.0.0</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
  	<link href="assets/css/cqf.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->

    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="fhir-logo" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="fhir-logo" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="fhir-logo" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="fhir-logo" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>
    <script type="text/javascript" src="assets/js/mermaid.js"></script>
    <script type="text/javascript" src="assets/js/mermaid-init.js"></script>
    <style type="text/css">h2{--heading-prefix:"7.20"}
    h3,h4,h5,h6{--heading-prefix:"7.20"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->

        <!-- Placeholder for child template header declarations -->


        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">Breast Cancer Screening and Management (BCSM) Clinical Decision Support (CDS) Implementation Guide</span>
            <br/>
            <span style="display:inline-block;">1.0.0 - ci-build


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="index.html">Home</a>
  </li>
  <li>
    <a href="background.html">Background</a>
  </li>
  <li>
    <a href="specification.html">Specification</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Artifacts
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="artifacts.html">FHIR Artifacts</a>
      </li>
      <li>
        <a href="terminology.html">Terminology</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="examples.html">Examples</a>
  </li>
  <li>
    <a href="downloads.html">Downloads</a>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><a href='artifacts.html'><b>Artifacts Summary</b></a></li><li><b>Average Risk</b></li>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">Breast Cancer Screening and Management (BCSM) Clinical Decision Support (CDS) Implementation Guide - Local Development build (v1.0.0) built by the FHIR (HL7® FHIR® Standard) Build Tools. See the <a href="http://cancerscreeningcds.github.io/bcsm-cds/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
  








<ul class="nav nav-tabs">

  <li class="active">
    <a href="#">Narrative Content</a>
  </li>



  
    <li>
      <a href="Library-AverageRisk.xml.html">XML</a>
    </li>
  


  
    <li>
      <a href="Library-AverageRisk.json.html">JSON</a>
    </li>
  


  
    <li>
      <a href="Library-AverageRisk.ttl.html">TTL</a>
    </li>
  



</ul>

  <a name="root"> </a>

  <h2 id="root">Library: Average Risk

  </h2>

  <table class="colsd">

    <tr>
      <td colspan="4"><i>Official URL</i>: <span class="copy-text">http://cancerscreeningcds.github.io/bcsm-cds/Library/AverageRisk<button title="Click to copy URL" class="btn-copy" data-clipboard-text="http://cancerscreeningcds.github.io/bcsm-cds/Library/AverageRisk"/></span>
      </td>
      <td><i>Version</i>:
      <span class="copy-text">1.0.0<button title="Click to copy versioned URL" class="btn-copy" data-clipboard-text="http://cancerscreeningcds.github.io/bcsm-cds/Library/AverageRisk|1.0.0"/></span>
      </td>
    </tr>

    <tr>







      <td colspan="4">
        
          Draft
          
            as of 2025-02-28
          
        
      </td>



      <td><i>Computable Name</i>: <span style="font-family: monospace;">AverageRisk</span></td>
    </tr>




  </table>



  <!-- insert intro if present -->
  



<!--  <p>
  Formats: <a href="Library-AverageRisk.xml.html">XML</a>, <a href="Library-AverageRisk.json.html">JSON</a>, <a href="Library-AverageRisk.ttl.html">Turtle</a>
  </p>-->

  


  <div xmlns="http://www.w3.org/1999/xhtml">
<div>
    <table class="grid dict">
        
        
        <tr>
            <th scope="row"><b>Title: </b></th>
            <td style="padding-left: 4px;">Average Risk</td>
        </tr>
        

        
        
        <tr>
            <th scope="row"><b>Id: </b></th>
            <td style="padding-left: 4px;">AverageRisk</td>
        </tr>
        

        
        
        <tr>
            <th scope="row"><b>Version: </b></th>
            <td style="padding-left: 4px;">1.0.0</td>
        </tr>
        

        
        <tr>
            <th scope="row"><b>Url: </b></th>
            <td style="padding-left: 4px;"><a href="Library-AverageRisk.html">Average Risk</a></td>
        </tr>
        

        

        

        
        <tr>
            <th scope="row"><b>Status: </b></th>
            <td style="padding-left: 4px;">draft</td>
        </tr>
        

        

        
        <tr>
            <th scope="row"><b>Type: </b></th>
            <td style="padding-left: 4px;">
                
                    
                        
                        <p style="margin-bottom: 5px;">
                            <b>system: </b> <span><a href="http://terminology.hl7.org/6.2.0/CodeSystem-library-type.html">http://terminology.hl7.org/CodeSystem/library-type</a></span>
                        </p>
                        
                        
                        <p style="margin-bottom: 5px;">
                            <b>code: </b> <span>logic-library</span>
                        </p>
                        
                        
                    
                
                
            </td>
        </tr>
        

        

        
        <tr>
            <th scope="row"><b>Date: </b></th>
            <td style="padding-left: 4px;">2025-02-28 23:16:14+0000</td>
        </tr>
        

        
        <tr>
            <th scope="row"><b>Publisher: </b></th>
            <td style="padding-left: 4px;">MITRE</td>
        </tr>
        

        

        

        

        

        

        

        

        

        

        

        

        
        <tr>
            <th scope="row"><b>Related Artifacts: </b></th>
            <td style="padding-left: 4px;">
                
                
                
                <p><b>Dependencies</b></p>
                <ul>
                  
                    <li><code>http://fhir.org/guides/cqf/common/Library/FHIR-ModelInfo|4.0.1</code></li>
                  
                    <li><code>http://cancerscreeningcds.github.io/bcsm-cds/Library/FHIRHelpers|4.0.1</code></li>
                  
                    <li><a href="Library-AverageRiskEvents.html">Average Risk Eventsversion: null1.0.0)</a></li>
                  
                    <li><a href="Library-AverageRiskActions.html">Average Risk Actionsversion: null1.0.0)</a></li>
                  
                    <li><a href="Library-DataElements.html">DataElementsversion: null1.0.0)</a></li>
                  
                    <li><a href="Library-BCSMCommonFunctions.html">BCSM Common Functionsversion: null1.0.0)</a></li>
                  
                </ul>
                
                
                
                
                
            </td>
        </tr>
        

        
        <tr>
          <th scope="row"><b>Parameters: </b></th>
          <td style="padding-left: 4px;">
            <table class="grid-dict">
              <tr><th><b>Name</b></th><th><b>Type</b></th><th><b>Min</b></th><th><b>Max</b></th><th><b>In/Out</b></th></tr>
              
                <tr><th>ACS</th><th>boolean</th><th>0</th><th>1</th><th>In</th></tr>
              
                <tr><th>USPSTF</th><th>boolean</th><th>0</th><th>1</th><th>In</th></tr>
              
                <tr><th>Patient</th><th>Patient</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeUnder45</th><th>Resource</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAge45to54</th><th>Resource</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeOver54</th><th>Resource</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>USPSTFAvgRisk</th><th>Resource</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>flow-AverageRisk</th><th>Resource</th><th>0</th><th>*</th><th>Out</th></tr>
              
                <tr><th>ExistsACSMammoAvgRiskAgeUnder45</th><th>boolean</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeUnder45Code</th><th>Coding</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeUnder45Reason</th><th>Coding</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeUnder45Timing</th><th>Resource</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeUnder45TimingEvent</th><th>string</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeUnder45Flag</th><th>Resource</th><th>0</th><th>*</th><th>Out</th></tr>
              
                <tr><th>ExistsACSMammoAvgRiskAge45to54</th><th>boolean</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAge45to54Code</th><th>Coding</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAge45to54Reason</th><th>Coding</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAge45to54Timing</th><th>Resource</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAge45to54TimingEvent</th><th>string</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAge45to54Flag</th><th>Resource</th><th>0</th><th>*</th><th>Out</th></tr>
              
                <tr><th>ExistsACSMammoAvgRiskAgeOver54</th><th>boolean</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeOver54Code</th><th>Coding</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeOver54Reason</th><th>Coding</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeOver54Timing</th><th>Resource</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeOver54TimingEvent</th><th>string</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>ACSMammoAvgRiskAgeOver54Flag</th><th>Resource</th><th>0</th><th>*</th><th>Out</th></tr>
              
                <tr><th>ExistsUSPSTFAvgRisk</th><th>boolean</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>USPSTFAvgRiskCode</th><th>Coding</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>USPSTFAvgRiskReason</th><th>Coding</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>USPSTFAvgRiskTiming</th><th>Resource</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>USPSTFAvgRiskTimingEvent</th><th>string</th><th>0</th><th>1</th><th>Out</th></tr>
              
                <tr><th>USPSTFAvgRiskFlag</th><th>Resource</th><th>0</th><th>*</th><th>Out</th></tr>
              
            </table>
          </td>
        </tr>
        

        
        <tr>
          <th scope="row"><b>Data Requirements:</b></th>
          <td style="padding-left: 4px;">
            <table class="grid-dict">
              <tr><th><b>Type</b></th><th><b>Profile</b></th><th><b>MS</b></th><th><b>Code Filter</b></th></tr>
              
                <tr>
                  <th>Patient</th>
                  <th>http://hl7.org/fhir/StructureDefinition/Patient</th>
                  <th/>
                  <th>
                    
                  </th>
                </tr>
              
            </table>
          </td>
        </tr>
        

        
        
        <tr>
          <td colspan="2">
            <table>
              <tr><th><a id="cql-content"><b>Content: </b></a> text/cql</th></tr>
              <tr><td><pre><code class="language-cql">/*  
  Author: CMS Alliance to Modernize Healthcare, operated by THE MITRE Corporation.

  (C) 2024 The MITRE Corporation. All Rights Reserved. 
  Approved for Public Release: 24-2711. 
  Distribution Unlimited.

  Unless otherwise noted, this work is available under an Apache 2.0 license. 
  It was produced by the MITRE Corporation for the Division of Cancer Prevention 
  and Control, Centers for Disease Control and Prevention in accordance with the 
  Statement of Work, contract number 75FCMC18D0047, task order number 75D30123F17931.
*/

library AverageRisk version '1.0.0'

using FHIR version '4.0.1'
include FHIRHelpers  version '4.0.1' called FHIRHelpers

include AverageRiskEvents version '1.0.0' called Events
include AverageRiskActions version '1.0.0' called Actions
include DataElements version '1.0.0' called DataElements
include BCSMCommonFunctions version '1.0.0' called BCSMCommon

parameter ACS System.Boolean default true
parameter USPSTF System.Boolean default true

context Patient

//------------------------------------------------------------------------------
// RECOMMENDATIONS
//------------------------------------------------------------------------------

define &quot;flow-AverageRisk&quot;:
  {    
    ACSMammoAvgRiskAgeUnder45,
    ACSMammoAvgRiskAge45to54,
    ACSMammoAvgRiskAgeOver54,
    USPSTFAvgRisk
  }   
  except { null }

define ACSMammoAvgRiskAgeUnder45:
  if ACS and Events.&quot;eve-ageUnder40&quot; or Events.&quot;eve-age40to44&quot; is true
  then Actions.&quot;act-acsavgrecs40&quot; else null 

define ACSMammoAvgRiskAge45to54:
  if ACS and Events.&quot;eve-Age45to54&quot; is true
  then Actions.&quot;act-acsavgrecs45&quot; else null    

define ACSMammoAvgRiskAgeOver54:
  if ACS and Events.&quot;eve-AgeOver54&quot; is true
  then Actions.&quot;act-acsavgrecs55&quot; else null  

define USPSTFAvgRisk:
  if USPSTF 
  then Actions.&quot;act-uspstfavgrecs&quot; else null  

//------------------------------------------------------------------------------
// DYNAMIC VALUES
//------------------------------------------------------------------------------    

define ExistsACSMammoAvgRiskAgeUnder45:
  ACSMammoAvgRiskAgeUnder45 is not null

define ACSMammoAvgRiskAgeUnder45Code:    
  ACSMammoAvgRiskAgeUnder45 R return R.code

define ACSMammoAvgRiskAgeUnder45Reason:
  ACSMammoAvgRiskAgeUnder45 R return R.reason

define ACSMammoAvgRiskAgeUnder45Timing:    
  ACSMammoAvgRiskAgeUnder45 R return R.timingTiming

define ACSMammoAvgRiskAgeUnder45TimingEvent:    
  ACSMammoAvgRiskAgeUnder45Timing R return First(R.event)  

define ACSMammoAvgRiskAgeUnder45Flag:
  ACSMammoAvgRiskAgeUnder45 R return BCSMCommon.CreateRecommendationFlagExtension(R.flag)    

define ExistsACSMammoAvgRiskAge45to54:
  ACSMammoAvgRiskAge45to54 is not null

define ACSMammoAvgRiskAge45to54Code:    
  ACSMammoAvgRiskAge45to54 R return R.code

define ACSMammoAvgRiskAge45to54Reason:
  ACSMammoAvgRiskAge45to54 R return R.reason

define ACSMammoAvgRiskAge45to54Timing:    
  ACSMammoAvgRiskAge45to54 R return R.timingTiming

define ACSMammoAvgRiskAge45to54TimingEvent:    
  ACSMammoAvgRiskAge45to54Timing R return First(R.event)  

define ACSMammoAvgRiskAge45to54Flag:
  ACSMammoAvgRiskAge45to54 R return BCSMCommon.CreateRecommendationFlagExtension(R.flag)

define ExistsACSMammoAvgRiskAgeOver54:
  ACSMammoAvgRiskAgeOver54 is not null

define ACSMammoAvgRiskAgeOver54Code:    
  ACSMammoAvgRiskAgeOver54 R return R.code

define ACSMammoAvgRiskAgeOver54Reason:
  ACSMammoAvgRiskAgeOver54 R return R.reason

define ACSMammoAvgRiskAgeOver54Timing:    
  ACSMammoAvgRiskAgeOver54 R return R.timingTiming

define ACSMammoAvgRiskAgeOver54TimingEvent:    
  ACSMammoAvgRiskAgeOver54Timing R return First(R.event)  

define ACSMammoAvgRiskAgeOver54Flag:
  ACSMammoAvgRiskAgeOver54 R return BCSMCommon.CreateRecommendationFlagExtension(R.flag)  

define ExistsUSPSTFAvgRisk:
  USPSTFAvgRisk is not null

define USPSTFAvgRiskCode:    
  USPSTFAvgRisk R return R.code

define USPSTFAvgRiskReason:
  USPSTFAvgRisk R return R.reason

define USPSTFAvgRiskTiming:    
  USPSTFAvgRisk R return R.timingTiming

define USPSTFAvgRiskTimingEvent:    
  USPSTFAvgRiskTiming R return First(R.event)

define USPSTFAvgRiskFlag:
  USPSTFAvgRisk R return BCSMCommon.CreateRecommendationFlagExtension(R.flag)    </code></pre></td></tr>
            </table>
          </td>
        </tr>
        
        
        
        
        
        <tr>
          <td colspan="2">
            <table>
              <tr><th><b>Content: </b> application/elm+xml</th></tr>
              <tr><td><pre><code>Encoded data (101676 characters)</code></pre></td></tr>
            </table>
          </td>
        </tr>
        
        
        
        
        <tr>
          <td colspan="2">
            <table>
              <tr><th><b>Content: </b> application/elm+json</th></tr>
              <tr><td><pre><code>Encoded data (184316 characters)</code></pre></td></tr>
            </table>
          </td>
        </tr>
        
        
    </table>
</div>
</div>

  <!-- insert notes if present -->
  



  

</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript" src="assets/js/window-hash.js"> </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div class="inner-wrapper">
        <p>
          IG &#169; 2025+ <a style="color:var(--footer-hyperlink-text-color)" href="https://www.mitre.org/">MITRE</a>.  Package cancerscreeningcds.fhir.us.bcsm-cds#1.0.0 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Fri, Feb 28, 2025 23:17+0000">2025-02-28</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                 
                
          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->

  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script type="text/javascript" src="assets/js/anchor-hover.js"> </script>
  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

